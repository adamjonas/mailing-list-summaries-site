<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>RFC for BIP: Derivation scheme for P2WPKH-nested-in-P2SH based accounts</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Pieter Wuille 2016-06-15 11:00:42
            <br><i>Published on: 2016-06-15T11:00:42+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2016/combined_RFC-for-BIP-Derivation-scheme-for-P2WPKH-nested-in-P2SH-based-accounts.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-June/012761.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a discussion on the bitcoin-dev mailing list, a user expressed concern about the privacy implications of using different output types for change outputs in transactions. The concern is that if both outputs are spent, it becomes visible which one was the P2WPKH-in-P2SH and which one was the pure P2WPKH, and this would lead to leaking information about which output was the change and which one was the actual sent output. As a solution, it was suggested to make it a requirement for "normal" send-to-single-address transactions to always use the same output type for the change output. To enhance privacy further, it was suggested that when there are multiple "sending" outputs, one should pick one at random and mimic it for the change output. This means that if you have a P2PKH and 3 P2SH sends, you'll have a 25% chance for a P2PKH change output and a 75% chance for a P2SH output. To maintain privacy even after these sends get spent, it is recommended to match the template of the redeemscript/witnessscript as well. For example, if the send being mimicked is a 2-of-3, the change output should also use 2-of-3.</p>
    <hr>
    <p><i> Updated on: 2023-05-19T23:31:21.832959+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>