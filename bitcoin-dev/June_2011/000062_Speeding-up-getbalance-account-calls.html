<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Speeding up &#34;getbalance &lt;account&gt;&#34; calls</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> jan at uos.de 2011-06-23 21:51:43
            <br><i>Published on: 2011-06-23T21:51:43+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2011/combined_Speeding-up-getbalance-account-calls.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2011-June/000062.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Jan, the founder of Instawallet, is facing a bottleneck issue with "getbalance" function taking a long time to complete due to bitcoind running through all relevant transactions each time anew to compute the balance. Jan seeks advice from the community on how he can improve this without doing invasive changes. He plans to implement a simple cache in bitcoind that caches calls to getbalance and invalidates the cache as soon as a new block or a transaction that affects the wallet comes in. However, he acknowledges that this solution is not perfect since blocks arrive every 10 minutes on average.Jan is considering a better solution where cache entries affected by a new transaction or arriving in a block are invalidated. This would require accounting for block chain reorgs which is complicated. He suggests invalidating the whole cache on reorgs since they occur seldom enough that it's not a big problem. Jan seeks suggestions on where in the source code to hook into to notice block chain reorgs.Although the perfect solution would be for bitcoind to keep running balances of all accounts and update them as new information becomes available, Jan doesn't feel confident enough to make such an improvement. He believes extensive testing of esoteric block chain reorgs would be necessary to achieve this. For now, he would like to continue letting bitcoind handle account handling to avoid worrying about block chain reorgs.</p>
    <hr>
    <p><i> Updated on: 2023-05-26T18:29:41.172527+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>