<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Safer sighashes and more granular SIGHASH_NOINPUT</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Pieter Wuille 2018-11-19 22:37:57
            <br><i>Published on: 2018-11-19T22:37:57+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Nov_2018/combined_Safer-sighashes-and-more-granular-SIGHASH-NOINPUT.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016488.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>A proposal has been made to add additional features to the Segwit version's Sighash. These include committing to the absolute transaction fee in addition to the amount being spent in each input, and committing to the scriptPubKey in addition to the scriptCode. The latter would prevent lying to devices about the type of output being spent, even when the scriptCode is correct. The proposal suggests making these optional as they may not be desirable in all circumstances. This interacts with SIGHASH_NOINPUT, which adds two ways of rebinding signatures to inputs: changing the prevout and changing the script. The proposal suggests three new sighash flags: SIGHASH_NOINPUT, SIGHASH_NOFEE, and SIGHASH_SCRIPTMASK. It also proposes adding a new opcode, OP_MASK, which acts as a NOP during execution. The sighash would be computed like in BIP143 but with some modifications. If SIGHASH_SCRIPTMASK is present, for every OP_MASK in scriptCode, the subsequent opcode/push is removed. The scriptPubKey being spent is added to the sighash unless SIGHASH_SCRIPTMASK is set. The transaction fee is added to the sighash unless SIGHASH_NOFEE is set. hashPrevouts, hashSequence, and outpoint are set to null when SIGHASH_NOINPUT is set.The proposal seeks to explicitly state what can change in signatures/scripts by indicating exactly what in a script is subject to change. The author asks if anyone can see ways in which this introduces redundant flexibility or misses obvious use cases.</p>
    <hr>
    <p><i> Updated on: 2023-05-20T18:09:16.762455+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>