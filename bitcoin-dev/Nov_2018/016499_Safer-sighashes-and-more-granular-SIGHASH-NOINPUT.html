<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Safer sighashes and more granular SIGHASH_NOINPUT</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Russell O&#39;Connor 2018-11-22 22:10:11
            <br><i>Published on: 2018-11-22T22:10:11+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Nov_2018/combined_Safer-sighashes-and-more-granular-SIGHASH-NOINPUT.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-November/016499.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Johnson Lau discusses the computation time and memory usage for scripts in a Bitcoin transaction. He estimates that for a script size of 128 bytes, including SHA256 padding, 2^20 scripts is 134MB and doubling it to 268MB for the merkle branch hashes. With roughly 100MB/s, this should take 2.5s or 42min for 30 levels. However, memory use is not considered. The issue of recomputing #5 scriptCode from BIP 143 each time with OP_CODESEPARATOR / OP_CHECKSIG pair is also discussed. While deprecating OP_CODESEPARATOR may be an option, given the combinatorial explosion in SIGHASH flag combinations and existing SigOp limitations, this may not be necessary. Additionally, MASTification can be used for more than 30 layers of sequential OP_IFs. One suggestion is to add an internal counter that increments on every control flow operator. Johnson favors using OP_CODESEPARATOR over adding more lines to the consensus code.</p>
    <hr>
    <p><i> Updated on: 2023-06-13T15:26:27.789663+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>