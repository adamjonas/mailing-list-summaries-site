<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>TXHASH + CHECKSIGFROMSTACKVERIFY in lieu of CTV and ANYPREVOUT</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Rusty Russell 2022-02-08 03:40:15
            <br><i>Published on: 2022-02-08T03:40:15+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Feb_2022/combined_TXHASH-CHECKSIGFROMSTACKVERIFY-in-lieu-of-CTV-and-ANYPREVOUT.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2022-February/019871.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Russell O'Connor, a contributor to the bitcoin-dev mailing list, has proposed decomposing the operations of CTV and ANYPREVOUT into their constituent pieces and then reassembling their behaviour programmatically. He proposes introducing two new operators, OP_TXHASH and OP_CHECKSIGFROMSTACKVERIFY. OP_TXHASH would pop a txhash flag from the stack and compute a tagged txhash in accordance with that flag, and push the resulting hash onto the stack. It can be further broken down into OP_TX and OP_TAGGEDHASH, or just reuse OP_SHA256. OP_TX concatenates selected fields onto the stack instead of hashing them, which is more compact for some tests and range testing.O'Connor believes that designing a robust set of TXHASH flags from the start can mitigate difficulties in upgrading TXHASH. He suggests having bits to control whether certain features are covered, such as versions, locktimes, txids, sequence numbers, input amounts and scriptpubkeys, output amounts and scriptpubkeys, tapbranch, tapleaf, opseparator value, input/output positions, and sighash flags. These easily map onto OP_TX, where certain values are pushed onto the stack. Pushing SHA256() of scripts instead of scripts themselves may reduce the possibility of DoS. O'Connor also suggests that defining 14 and 15 as two bits could be useful.</p>
    <hr>
    <p><i> Updated on: 2023-06-15T15:38:41.204299+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>