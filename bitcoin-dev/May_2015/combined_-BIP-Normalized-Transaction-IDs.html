<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>[BIP] Normalized Transaction IDs <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008202_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Stephen Morse 2015-05-19 12:48:20+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008199_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-19 10:43:39+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008198_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-19 09:13:17+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008196_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-19 08:28:58+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008183_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-16 10:52:34+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008181_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Stephen 2015-05-16 03:58:56+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008179_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Luke Dashjr 2015-05-15 16:31:47+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008178_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-15 10:45:05+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008177_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>s7r 2015-05-15 09:54:55+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008175_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-14 11:26:44+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008174_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-14 11:01:56+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008163_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Pieter Wuille 2015-05-14 00:37:30+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008161_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-13 20:32:43+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008160_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Pieter Wuille 2015-05-13 20:31:06+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008159_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-13 20:27:14+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008157_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Pieter Wuille 2015-05-13 19:40:54+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008156_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-13 19:14:57+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008155_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Pieter Wuille 2015-05-13 18:40:34+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008154_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-13 18:11:30+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008153_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-13 18:04:54+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008151_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Pieter Wuille 2015-05-13 17:14:07+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008150_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Luke Dashjr 2015-05-13 16:34:52+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008149_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-13 16:18:24+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008147_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-13 15:24:34+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008145_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Gavin Andresen 2015-05-13 13:41:44+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008142_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Tier Nolan 2015-05-13 13:12:43+00:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2015/008141_-BIP-Normalized-Transaction-IDs.html">[BIP] Normalized Transaction IDs</a>
                        <b>Christian Decker 2015-05-13 12:48:04+00:00</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-May/008202.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2015-05-19T12:48:20+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The discussion revolves around the proposal to include the height in transactions without adding an extra field. It is suggested that for non-coinbase transactions, the height used is zero, while for coinbase transactions, the height specified in the scriptSig is copied into the locktime of the transaction before computing the normalized transaction ID.However, it is argued that there's no need to replace lock times or any other part of the transaction. Instead, the height can be serialized right before serializing the transaction, and 0 can be pre-serialized for non-coinbase transactions. The normalization process for non-coinbase transactions involves replacing prevout hash with normalized hash and clearing the scriptSig. Finally, the transaction is serialized using CHashWriter.Christian Decker raises concerns about addressing BIP 34 and avoiding hashed transactions in different ways. Tier Nolan responds by suggesting that the normalized TXID should not depend on the height for non-coinbase transactions, as it would cause mutation when added to the chain. For coinbase transactions, they want the height to be included. The height is proposed to be included in the scriptSig for all transactions, with a height of zero for non-coinbase transactions. Adding an extra field to include the height is not necessary. A rule can be implemented where the height specified in the scriptSig in coinbase transactions is copied into the locktime of the transaction before computing the normalized transaction ID. Nolan suggests that the normalized txid could add the height to the txids of all inputs, while non-coinbase transactions would have heights of zero. The scriptSig in the coinbase is intended to be "random" bytes/extra nonce, so putting a restriction on it was guaranteed to be backward compatible.In an email exchange from May 19, 2015, Christian Decker proposes two proposals to address BIP 34. He suggests including the height in the scriptSig for all transactions, with non-coinbase transactions using a height of zero. The normalized txid function could incorporate the height without any specific inclusion method. The previous txid for coinbases is required to be all zeros, so the normalized txid could add the height to the txids of all inputs. Decker assumes that the scriptSig in the coinbase is intended to be random and therefore backward compatible.Christian Decker proposed a BIP to normalize transaction IDs to address transaction malleability and simplify higher-level protocols. The normalized transaction ID is calculated by removing the scriptSig before computing the hash, ensuring that only data guaranteed by the signatures influences the hash. This guarantees that any change to the normalized ID will invalidate the signature. Validating clients supporting this BIP would use both the normalized tx ID and the legacy tx ID when validating transactions. Template transactions can now be used to build sequences of transactions before signing them. The proposal requires a hardfork but suggests that hardforks should not be feared. The details of how the hardfork is to be done were left out, as it does not matter, and a good mechanism may exist to apply multiple hardforks concurrently in the future.Stephen raises concerns about how BIP34 affects normalized transaction ids in a discussion about implementing a new block height rule. He suggests that normalized txids should strip scriptSigs of all transactions except for coinbase transactions to prevent replay attacks. Another contributor agrees and proposes replacing the scriptSig for coinbases with the height expressed as a varint, which would give all coinbases a unique normalized txid while still preventing spendable duplicates.In an email exchange, s7r discusses the issue of scriptSig and txid being stripped for safety against replays. However, this method is not safe enough as it does not account for multiple scriptPubKeys per transaction. Instead, Luke proposes a scriptPubKey-only sighash type that would provide strong safety in all malleability situations. This would enable advanced wallet software to take advantage of it in the future while strictly enforcing no-reuse on its own wallet to avoid known replays.In response to s7r's question about how a certain process can be safe against malleability of the parent transaction and replays, it is explained that the signature signs everything except itself and the normalized txid doesn't include the signature, so mutations of the signature won't change the normalized txid. If the refund transaction refers to the parent using the normalized txid, then it doesn't matter if the parent has a mutated signature, as the normalized transaction ignores such changes. If there are two transactions that are mutations of each other, only one can be added to the blockchain since the other is a double spend. The normalized txid refers to all of them rather than a specific transaction. Mutation is only a problem if it occurs after signing.</p>
        <hr>
        <p><i>Updated on: 2023-08-01T12:44:01.437339+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>