<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>cleanstack alt stack &amp; softfork improvements (Was: Merkle branch verification &amp; tail-call semantics for generalized MAST)</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Johnson Lau 2017-09-21 03:58:05
            <br><i>Published on: 2017-09-21T03:58:05+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Sept_2017/combined_cleanstack-alt-stack-softfork-improvements-Was-Merkle-branch-verification-tail-call-semantics-for-generalized-MAST-.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-September/015031.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In an email conversation between Mark Friedenbach and Johnson Lau, they discuss the possibility of using a new script version for every new op code that is added to avoid confusion. Johnson suggests moving the script version to the witness, which Friedenbach clarifies as having two separate version values - one in the scriptPubKey and another in the witness which gates functionality in script or whatever else is used by that witness type. The “script version” field should be renamed “witness type” as it will only be used to encode how to check the witness commitment in the scriptPubKey against the data provided in the witness. Upgrades and improvements to the features supported by those witness types won’t require new top-level witness types to be defined. Defining a new opcode, even one with modifies the stack, doesn’t change the hashing scheme used by the witness type. Friedenbach also suggests that v0,32-bytes should have hashed the top two values, one of which would have been the real script version. This could be fixed however, even without introducing a new witness type. Do a soft-fork upgrade that checks if the witness redeem script is push-only, and if so then pop the last push off as the script version (>= 1), and concatenate the rest to form the actual redeem script. v1,32-bytes would then be used for a template version of MAST, or whatever other idea comes along that fundamentally changes the way the witness commitment is calculated. Johnson agrees with Friedenbach's suggestion and reiterates that they should use v1, 32-byte to define the basic structure of Merklized Script and define the script version inside the witness.</p>
    <hr>
    <p><i> Updated on: 2023-05-20T03:58:11.687936+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>