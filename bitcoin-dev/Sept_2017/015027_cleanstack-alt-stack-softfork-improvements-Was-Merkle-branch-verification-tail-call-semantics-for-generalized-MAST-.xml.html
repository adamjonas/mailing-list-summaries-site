<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>cleanstack alt stack &amp; softfork improvements (Was: Merkle branch verification &amp; tail-call semantics for generalized MAST)</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Mark Friedenbach 2017-09-20 19:29:17
            <br><i>Published on: 2017-09-20T19:29:17+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Sept_2017/combined_cleanstack-alt-stack-softfork-improvements-Was-Merkle-branch-verification-tail-call-semantics-for-generalized-MAST-.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-September/015027.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In an email sent on September 19, 2017, Johnson Lau proposed using a new script version for every new opcode added to avoid ugliness. However, he suggested moving the script version to the witness in the new BIP114 instead of having two separate version values. He argued that there should be two separate version values â€” one in the scriptPubKey and another in the witness that gates functionality in script or whatever else is used by that witness type. Lau stated that defining a new opcode does not change the hashing scheme used by the witness type.Lau recommended renaming the visible "script version" field to "witness type" since it will only be used in the future to encode how to check the witness commitment in the scriptPubKey against the data provided in the witness. Upgrades and improvements to the features supported by those witness types won't require new top-level witness types to be defined. Regarding v0,32-bytes, it presently calculates the double-SHA256 hash of the top-most serialized item on the stack and compares that against the 32-byte commitment value. However, Lau argued that it probably should have hashed the top two values, one of which would have been the real script version, and suggested fixing this without introducing a new witness type. He recommended doing a soft-fork upgrade that checks if the witness redeem script is push-only. If so, then pop the last push off as the script version (>= 1) and concatenate the rest to form the actual redeem script. Lau suggested using v1,32-bytes for a template version of MAST or any other idea that fundamentally changes the way the witness commitment is calculated.</p>
    <hr>
    <p><i> Updated on: 2023-06-12T18:56:38.798465+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>