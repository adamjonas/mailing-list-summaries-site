<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>BIP70 message delivery reliability <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004248_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 05:47:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004254_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 11:42:56</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004257_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Pieter Wuille 2014-01-30 12:02:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004259_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Roy Badami 2014-01-30 12:20:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004254_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 11:42:56</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004256_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 11:59:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004248_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 05:47:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004257_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Pieter Wuille 2014-01-30 12:02:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004260_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 12:38:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004252_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 11:15:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004253_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 11:31:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004255_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Pieter Wuille 2014-01-30 11:46:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004256_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 11:59:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004260_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 12:38:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004248_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 05:47:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004255_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Pieter Wuille 2014-01-30 11:46:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004258_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 12:03:57</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004250_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 10:49:32</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004252_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 11:15:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004254_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 11:42:56</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004255_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Pieter Wuille 2014-01-30 11:46:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004256_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 11:59:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004258_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 12:03:57</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004250_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 10:49:32</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004258_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 12:03:57</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004250_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 10:49:32</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004252_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Chuck 2014-01-30 11:15:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004253_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 11:31:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004257_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Pieter Wuille 2014-01-30 12:02:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004259_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Roy Badami 2014-01-30 12:20:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004260_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 12:38:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004253_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Mike Hearn 2014-01-30 11:31:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Jan_2014/004259_BIP70-message-delivery-reliability.xml.html">BIP70 message delivery reliability</a>
                        <b>Roy Badami 2014-01-30 12:20:16</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2014-January/004248.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2014-01-30T05:47:51+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The article discusses various scenarios and concerns related to payment transactions in the Bitcoin network. One of the proposed solutions is a slightly improved protocol that includes a set of required steps, such as the customer clicking "pay now," the merchant sending PaymentRequest/PaymentDetails which should be signed, the customer building a set of transactions and sending a new PaymentApprovalRequest message, and the merchant responding with a PaymentApproved message. Optional steps include the customer sending a Payment message and the merchant responding with a PaymentACK message. This protocol provides an extra layer of redundancy and ensures that if a message delivery fails, nobody is harmed because the purchase is incomplete.In email conversations between Chuck, Pieter Wuille, and Mike Hearn, they discussed the way transactions are committed to wallets in bitcoinj. They suggested retrying with exponential backoff to prevent transactions from confirming without delivering the payment message. Chuck believes that discussing failure situations beforehand is essential rather than trying to patch solutions later. They also discussed the use of arbitrators in Bitcoin transactions and whether it places unnecessary trust in third parties. They suggested adding signing to PaymentACK and other measures to address this issue in the future.The conversation highlights the need for careful consideration of the current implementation's weaknesses and addressing them before evolving the protocol further. It is important to talk about failure situations now, rather than trying to patch solutions later. The ACK is not particularly important in the current design, but if the situation becomes frequent, improvements can be made. Overall, there is a need for a more atomic protocol that prevents transactions from confirming without delivering the payment message and addresses potential problems with arbitration.Chuck proposed a solution to make the protocol more atomic by storing transactions in the sender's client and retrying with exponential backoff to prevent transactions from confirming without the payment message ever being delivered. In another conversation, Chuck suggested that a receipt including PaymentRequest and transactions could suffice for proving payment, and emphasized the importance of the customer signing the message with the private key of the refund address in Step 3. The email conversations highlight the need for careful consideration of the current implementation's weaknesses and addressing them before evolving the protocol further. The importance of backwards compatibility is also emphasized throughout the discussions.While there are differences in how transactions are committed to wallets in bitcoinj compared to the specification and Bitcoin core master, it's unclear what the implications of these differences are. If the server goes silent after receiving a Payment message, the delivery can be retried, but there is a possibility that the user may pay without receiving an acknowledgement (ACK) from the merchant. In such cases, it is suggested to invalidate all transactions in the Payment message by broadcasting a send-to-self transaction as soon as possible to avoid an indeterminate wallet balance.In case of arbitration in payment transactions, the arbitrator would have rules in place to determine what is an acceptable form of payment, and HTTP has response codes for submission of Payment messages. There is also potential to add signing to PaymentACK and other features in the future if necessary. The way transactions are committed to wallets in bitcoinj was discussed between Chuck, Pieter Wuille, and Mike Hearn. The tx is only committed if the server accepts the Payment message and acknowledges it, so any failure submitting or internal server error would show the payment as failed on the UI. While this approach was agreed upon as the right way to do it, it is not necessarily what is required by the current specification or implemented in Bitcoin Core master.</p>
        <hr>
        <p><i>Updated on: 2023-06-08T02:13:54.630924+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>