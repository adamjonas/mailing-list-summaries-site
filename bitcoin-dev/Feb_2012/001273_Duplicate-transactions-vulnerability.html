<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Duplicate transactions vulnerability</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Ben Reeves 2012-02-28 20:35:05
            <br><i>Published on: 2012-02-28T20:35:05+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/combined_Duplicate-transactions-vulnerability.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-February/001273.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a Bitcoin development mailing list, Pieter Wuille suggested adding an extra protocol rule to prevent a possible attack on the network. He explained that before the P2SH protocol change, a miner could combine a duplicate coinbase and an invalid P2SH transaction to create a block, which would still be guaranteed to be orphaned but have excellent network propagation. However, if someone were to do this on the day of the P2SH switchover, it could corrupt the database of all clients. To fix this issue, Wuille proposed not allowing blocks to contain a transaction whose hash is equal to that of a former transaction that has not yet been completely spent, as written in BIP30. There is a patch for the reference client that has been tested and verified to make the attack impossible. Wuille asked for support for adding this rule to the protocol rules, hoping pools and miners can agree to update their nodes without lengthy coinbase-flagging procedures that would only delay a solution. Another member of the mailing list suggested doing it in two steps to prefer blocks that don't break the rule first, then treat it as a hard rule once 55%+ are confirmed to have upgraded.</p>
    <hr>
    <p><i> Updated on: 2023-06-06T03:08:23.623169+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>