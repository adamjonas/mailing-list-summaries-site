<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Duplicate transactions vulnerability <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001265_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 16:48:39</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001290_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-02 01:56:34</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001287_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Gregory Maxwell 2012-03-01 14:27:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001277_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 16:47:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001267_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 17:18:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001299_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-03 16:41:03</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2012/001288_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-03-01 14:30:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001284_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-29 23:45:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001281_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Matt Corallo 2012-02-29 22:38:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2012/001272_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
                        <b>Pieter Wuille 2012-02-28 20:24:15</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-February/001265.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2012-02-28T16:48:39+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>A vulnerability has been found in how the Bitcoin reference client deals with duplicate transactions. Exploiting it is rather complex, requires some hash power, and has no financial benefit for the attacker. To fix this, an extra protocol rule can be added to not allow blocks to contain a transaction whose hash is equal to that of a former transaction which has not yet been completely spent. There is a patch for the reference client which has been tested and verified to make the attack impossible. The change is backward compatible in the same way BIP16 is: if a supermajority of mining power implements it, old clients can continue to function without risk.Russell O'Connor described the attack on his blog. Ben Reeves pointed out two potential small weaknesses in the proposed patch, but Pieter has updated the patch and will update the BIP soon.Pieter Wuille, a Bitcoin developer, has created patches for the reference client to fix a vulnerability that allows for blockchain corruption. The change is backward compatible and only requires a supermajority of mining power to implement it. Wuille reached out to pool operators to upgrade their nodes and confirm when they have done so. He also asked miners and pool operators who have the ability to upgrade to do so as well.The purpose of this email is asking for support to add an extra protocol rule not to allow blocks containing a transaction whose hash is equal to a former transaction that has not yet been spent completely. Wuille proposed adding the rule to the protocol rules and requiring pools and miners to update their nodes without a lengthy coinbase-flagging procedure that would delay a solution. If there is consensus, he expects the security update to be deployed on March 15, 2012.The vulnerability was found in how the Bitcoin reference client deals with duplicate transactions. Although exploiting it requires some hash power and has no financial benefit for attackers, it is still considered a security hole. If someone takes advantage of the vulnerability, none BIP30 clients on the short blockchain will be vulnerable to transaction reversal of six confirmations or more. A malicious miner can produce a duplicate coinbase, fork chain without a dupe, and spend the old coinbase, causing the blockchain to fork. Wuille suggested patching DisconnectBlock() to prevent this in a backward-compatible way before any protocol change.Moreover, he proposed adding the block height to the coinbase as a reasonable solution to disallowing duplicate coinbases entirely. However, because coinbases are used for all kinds of things already, this is harder to roll out network-wide. Hence, first, this “emergency” solution that already prevents all practical attacks, and, in a later step, forcing unique coinbases, so that transactions can be assumed to be unique identifiable by their hash again. Duplicate coinbase transactions are possible (by badly written software or malicious intent), and transactions that spend duplicate coinbases can be made to have the same hash as well.</p>
        <hr>
        <p><i>Updated on: 2023-05-19T03:05:57.571981+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>