<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Duplicate transactions vulnerability</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Matt Corallo 2012-02-29 22:38:13
            <br><i>Published on: 2012-02-29T22:38:13+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/combined_Duplicate-transactions-vulnerability.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-February/001281.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In February 2012, Pieter Wuille reached out to the Bitcoin community inquiring about support for an extra protocol rule. The rule would prohibit blocks from containing a transaction whose hash is equal to that of a former transaction which has not yet been completely spent. This vulnerability had been found in how the Bitcoin reference client deals with duplicate transactions. Exploiting it is complex, requires some hash power, and has no financial benefit for the attacker. However, it still poses a security risk that needed fixing. Wuille's solution is backward compatible in the same way as BIP16. If a supermajority of mining power implements it, old clients can continue to function without risk. Ben Reeves warned that assuming 50% of hashing power adopts BIP30 but the actual client install base is relatively low, the patch will likely result in a "hard" blockchain split if someone takes advantage. He added that a malicious miner could produce a duplicate coinbase which the majority of clients will accept, but the majority of hashing power won't. Spending the coinbase output after disconnection will cause the blockchain to fork. All none BIP30 clients on the short blockchain will be vulnerable to transaction reversal of 6 confirmations or more. Reeves suggested that this should be patched in DisconnectBlock() before any protocol change. He also suggested that maybe a new mapByCoinbase multimap is needed. In response, Matt advised that when rolling out the update, they have to make sure they have 50%, not just 50%. Something like 60%-75% should do fine. He added that they just have to be very, very vocal about the change when it happens and make sure miners are all on board.</p>
    <hr>
    <p><i> Updated on: 2023-05-18T23:35:26.076682+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>