<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>OP_SECURETHEBAG (supersedes OP_CHECKOUTPUTSVERIFY)</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Jeremy 2019-10-03 23:22:47
            <br><i>Published on: 2019-10-03T23:22:47+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Oct_2019/combined_OP-SECURETHEBAG-supersedes-OP-CHECKOUTPUTSVERIFY-.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-October/017349.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Jeremy Rubin has updated the BIP to no longer be based on Taproot but instead based on an OP_NOP upgrade. The BIP defines OP_NOP4 with the same semantics as previously presented, enabling OP_SECURETHEBAG for segwit and bare script, but not P2SH. The prior version of the BIP remains available. An example implementation and tests have also been updated, and a bare OP_SECURETHEBAG script is now standard as it is a common use case. In response to Dmitry Petukhov's feedback, multibyte opcodes can be more cleanly specified once Tapscript is fully prepared with more thorough script parsing improvements. Petukhov suggests using another signature to commit to the whole transaction to eliminate malleability and explains how a control-sig could be used to restrict outputs. He also proposes two additional flags for sighash: NOPREVOUT and NOSCRIPT, which would allow for ANYPREVOUT/NOINPUT and ANYPREVOUTANYSCRIPT, respectively. Petukhov suggests using this mechanism to transfer the right to spend certain UTXOs without actually moving them. Anthony Towns suggests simulating OP_SECURETHEBAG with an ANYPREVOUT (NOINPUT) sighash and calculates a signature for some pubkey P. Both scripts are automatically satisfied when revealed with the correct set of outputs and require no additional witness data. If X is constructed via script instead of hardcoded, the same effect can be achieved with CAT, LEFT, and RIGHT.</p>
    <hr>
    <p><i> Updated on: 2023-06-13T19:12:46.563207+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>