<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Unenforceable fee obligations in multiparty protocols with Taproot inputs</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Andrew Poelstra 2023-02-07 13:46:22
            <br><i>Published on: 2023-02-07T13:46:22+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Feb_2023/combined_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-February/021448.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a Bitcoin developer mailing list, Yuval Kogman raised concerns regarding the Taproot feature, which could allow one party in a multiparty transaction to extract an unfair fee contribution from other parties. This is done by using a larger-than-estimated signature on the last input in the transaction while keeping absolute fees the same, thus reducing the feerate for the transaction. However, using Miniscript, participants can determine the maximum witness size of the tree and sign under their desired conditions. The use of uncompressed keys can also cause "surprise" witness inflation, but this is expected to be rare. Miniscript allows users to optimize witness size by signing only under specific conditions rather than just optimistically reducing witness size. There are two cases where the attack can still occur: if there is a more expensive branch that could be taken without Alice's signature, or if there is a more expensive branch that could be taken by moving Alice's signature. Fortunately, Miniscript provides tools for Alice to identify which case applies and determine the maximum witness size. Taproot features CODESEPARATOR opcode to prevent signatures from migrating to another branch or within a branch. The redesign of CODESEPARATOR for Taproot was specifically intended to address issues of witness malleation.</p>
    <hr>
    <p><i> Updated on: 2023-06-16T15:26:57.542255+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>