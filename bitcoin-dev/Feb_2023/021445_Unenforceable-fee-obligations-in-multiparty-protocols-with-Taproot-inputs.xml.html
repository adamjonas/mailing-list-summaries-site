<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Unenforceable fee obligations in multiparty protocols with Taproot inputs</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Lloyd Fournier 2023-02-07 04:38:30
            <br><i>Published on: 2023-02-07T04:38:30+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Feb_2023/combined_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-February/021445.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The email conversation between Yuval and LL discusses a potential attack scenario in multiparty transactions, exploiting the variable size of Taproot spends. The last input signed can use a larger signature to unfairly extract fee contributions from other parties, without affecting absolute fees but reducing the feerate for the transaction. In this scenario, Mallory registers a P2TR output with a large script spend path, such as an ordinal inscription commitment transaction output, and commits to a fee obligation calculated on the basis of a key spend. When all other participants have provided signatures, the script spend path can be used. This attack effectively steals a fee from other participants since their signatures do not directly or indirectly commit to a feerate. There are several mitigations proposed to prevent this attack, including negotiating a lower feerate ahead of time, enforcing minimal weight before signing, using a trusted coordinator, providing publicly verifiable protocol transcripts, increasing costliness, and requiring signature ordering. However, each mitigation has its limitations and trade-offs. For instance, RBF can be prevented by pinning attacks, while minimum confirmation age may not work in the context of lightning channels. Hence, the authors suggest implementing multiple mitigations simultaneously.</p>
    <hr>
    <p><i> Updated on: 2023-06-16T15:26:46.316431+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>