<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Unenforceable fee obligations in multiparty protocols with Taproot inputs <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021460_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Anthony Towns 2023-02-11 05:14:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021462_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Anthony Towns 2023-02-12 06:47:31</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021446_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Nadav Ivgi 2023-02-07 09:36:58</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021447_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 12:50:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021450_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-07 18:10:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021451_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 18:12:36</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021456_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Michael Folkson 2023-02-08 09:34:57</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021461_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-11 14:40:38</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021444_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Yuval Kogman 2023-02-07 02:49:28</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021446_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Nadav Ivgi 2023-02-07 09:36:58</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021454_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Antoine Riard 2023-02-08 00:56:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021456_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Michael Folkson 2023-02-08 09:34:57</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021444_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Yuval Kogman 2023-02-07 02:49:28</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021446_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Nadav Ivgi 2023-02-07 09:36:58</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021454_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Antoine Riard 2023-02-08 00:56:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021456_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Michael Folkson 2023-02-08 09:34:57</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021457_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-08 14:00:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021460_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Anthony Towns 2023-02-11 05:14:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021466_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Antoine Riard 2023-02-15 03:33:24</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021445_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Lloyd Fournier 2023-02-07 04:38:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021447_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 12:50:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021457_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-08 14:00:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021461_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-11 14:40:38</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021445_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Lloyd Fournier 2023-02-07 04:38:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021448_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-07 13:46:22</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021452_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-07 18:35:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021453_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 19:04:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021454_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Antoine Riard 2023-02-08 00:56:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021458_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-08 14:04:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021459_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Yuval Kogman 2023-02-10 19:35:06</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021462_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Anthony Towns 2023-02-12 06:47:31</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021466_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Antoine Riard 2023-02-15 03:33:24</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021445_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Lloyd Fournier 2023-02-07 04:38:30</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021458_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-08 14:04:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021459_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Yuval Kogman 2023-02-10 19:35:06</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021462_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Anthony Towns 2023-02-12 06:47:31</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021448_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-07 13:46:22</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021450_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-07 18:10:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021451_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 18:12:36</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021452_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-07 18:35:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021453_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 19:04:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021458_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-08 14:04:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021459_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Yuval Kogman 2023-02-10 19:35:06</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021466_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Antoine Riard 2023-02-15 03:33:24</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021444_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Yuval Kogman 2023-02-07 02:49:28</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021447_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 12:50:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021448_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-07 13:46:22</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021450_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-07 18:10:10</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021451_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 18:12:36</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021452_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-07 18:35:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021453_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Peter Todd 2023-02-07 19:04:00</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021457_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Andrew Poelstra 2023-02-08 14:00:48</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021460_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Anthony Towns 2023-02-11 05:14:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2023/021461_Unenforceable-fee-obligations-in-multiparty-protocols-with-Taproot-inputs.html">Unenforceable fee obligations in multiparty protocols with Taproot inputs</a>
                        <b>Russell O&#39;Connor 2023-02-11 14:40:38</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-February/021460.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2023-02-11T05:14:55+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>On the Bitcoin development mailing list, there have been discussions revolving around possible vulnerabilities in Taproot design. One such vulnerability is a potential fee extraction attack due to variable size spends in Taproot. An attacker can register a P2TR output with a large script spend path as an input and then use the script spend path to steal a fee from other parties once all other participants have provided signatures. Mitigations proposed for this issue include negotiating a lower feerate ahead of time, using BIP-322 ownership proofs, enforcing a minimum weight for non-witness data, and requiring a minimum confirmation age or feerate for inputs.Another bug in Taproot was identified where the same Tapleaf can be repeated multiple times, potentially at different Taplevels, incurring different Tapfee rates. It is suggested that proving a spending path exists within a Taproot tree only requires a subset of the Tapleaf hashes. To countermeasure this issue, it is recommended to know the entire Taptree when interacting with someone's Tapspend. Uncompressed keys can lead to witness inflation, but they have been banned since the implementation of segwit. The CODESEPARATOR opcode can prevent signature migration within a tapbranch or between branches in Taproot.There have also been discussions on possible vulnerabilities in coinjoin transactions. The latest signer may provide an inflated witness which downgrades the multi-party transaction feerate, causing transaction-relay jamming. Miniscript can be used to optimize witness size by signing only under specific conditions. In a multiparty transaction, one party could extract an unfair fee contribution from others by using a larger-than-estimated signature, but mitigations such as negotiating a minimum feerate ahead of time and enforcing a minimal weight for all non-witness data can prevent this.Regarding the Taproot bug, Russell O'Connor reported that the same Tapleaf can be repeated multiple times within the same Taproot, potentially incurring different Tapfee rates at different Taplevels. Countermeasures include always knowing the entire Taptree when interacting with someone's Tapspend and using RBF on taproot witnesses to replace deeper, less efficient tapleaf scripts with shallower, more efficient ones. Andrew Poelstra clarified that this issue can be fixed by signing the entire tapbranch instead of the tapleaf.Arbitrary scripts could lead to DoS attacks, so it is crucial to establish a minimum feerate that can be forced. Additionally, uncompressed pubkeys can double scriptSigs and cause witness inflation, but Miniscript provides tools to identify maximum witness size and prevent this issue.Finally, Andrew Poelstra corrected himself regarding the tapleaf hash being covered by the signature, not included in some ANYONECANPAY proposals. He also provided information on preventing signatures from migrating within a branch using the CODESEPARATOR opcode, which was redesigned in Taproot for this purpose.</p>
        <hr>
        <p><i>Updated on: 2023-06-16T15:29:11.705758+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>