<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Full Disclosure: CVE-2021-31876 Defect in Bitcoin Core&#39;s bip125 logic</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Luke Dashjr 2021-05-11 21:50:50
            <br><i>Published on: 2021-05-11T21:50:50+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/May_2021/combined_Full-Disclosure-CVE-2021-31876-Defect-in-Bitcoin-Core-s-bip125-logic.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018922.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard reported a defect in the Bitcoin Core bip125 logic with minor security and operational implications for downstream projects. The defect affects Bitcoin Core nodes 0.12.0 and above, but base layer safety is not affected. The Bip 125 specification describes two ways a transaction can signal that it is replaceable. An unconfirmed child transaction with nSequence = 0xff_ff_ff_ff spending an unconfirmed parent with nSequence the child transaction signals "through inheritance". However, the replacement code as implemented in Core's `PreChecks()` shows that this behavior isn't enforced and Core's mempool rejects replacement attempts of an unconfirmed child transaction.The defect has not been patched yet. Downstream projects affected include LN, Onchain DLC/Coinswap/Vault, Coinjoin/Cut-Through, and Simple wallets. LN nodes operators concerned by this defect might favor anchor outputs channels, fully mitigating this specific pinning vector. To the best of Riard's knowledge, he didn't identify other deployed protocols of which coins safety are impacted by this defect.The lack of an established policy for coordinated security disclosures between a base layer implementation and its downstream projects, the lack of a clear methodology to identify downstream projects affected by a transaction relay policy wreckage, and the lack of minimally-disruptive, emergency upgrade mechanisms implemented by downstream projects are some interesting points underlined by this defect. Finally, security implications for downstream projects provoked by base layer issues shouldn't be minimized as they do have a risk of windblow on base layer operations.The timeline for this defect report started from 2021-03-18 to 2021-05-06. The information reported by Antoine Riard reflects the best of his knowledge.</p>
    <hr>
    <p><i> Updated on: 2023-06-14T20:42:30.764397+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>