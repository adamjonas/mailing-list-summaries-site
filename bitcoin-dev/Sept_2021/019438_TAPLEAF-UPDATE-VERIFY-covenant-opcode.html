<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>TAPLEAF_UPDATE_VERIFY covenant opcode</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Anthony Towns 2021-09-11 03:26:44
            <br><i>Published on: 2021-09-11T03:26:44+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Sept_2021/combined_TAPLEAF-UPDATE-VERIFY-covenant-opcode.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-September/019438.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In an email exchange, Antoine Riard and Andrew Poelstra discussed various aspects of Taproot and its implementation. They talked about a new opcode called OP_MERKLESUB, which checks the output N has the same scripts as the current input except with the current script removed, and with its internal pubkey as the current input's internal pubkey plus P. They also discussed the possibility of introducing a separate OP_MERKLEADD to add a point to the internal pubkey group signer. However, Poelstra believes that saving a byte of witness data at the cost of specifying additional opcodes seems like optimizing the wrong thing. They also discussed the issue of verifying that the new utxo retains the bitcoin that was in the old utxo. Poelstra suggested using a new opcode called IN_OUT_AMOUNT that pushes two items onto the stack: the amount from this input's utxo and the amount in the corresponding output. This way, anyone using TLUV can use maths operators to verify that funds are being appropriately retained in the updated scriptPubKey. They also talked about the SIGHASH_GROUP design and how it achieves the same effect as IN_OUT_AMOUNT, at least for the CoinPool use-case.Moreover, they touched upon the topic of automated market makers and how they work on different chains aiming to support multiple asset types, but not on Bitcoin directly. They also talked about tweaking the formula so that one makes a profit, which also means that the fund pool becomes more liquid over time. They concluded by discussing the issues with the CAT "TapBranch" SHA256 DUP CAT SWAP CAT SHA256 logic and proposing the introduction of an opcode that builds a merkle root from tagged hashes directly rather than one that lets you compare to 32B strings so that you can do the TapBranch logic manually.</p>
    <hr>
    <p><i> Updated on: 2023-05-21T03:52:14.686361+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>