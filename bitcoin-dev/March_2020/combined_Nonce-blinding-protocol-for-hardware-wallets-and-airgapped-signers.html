<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Nonce blinding protocol for hardware wallets and airgapped signers <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017655_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Stepan Snigirev 2020-02-27 02:59:46</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017656_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>freedom at reardencode.com 2020-02-27 03:26:07</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017662_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Stepan Snigirev 2020-02-28 14:40:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017663_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Marko 2020-02-28 17:42:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2020/017665_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Dustin Dettmer 2020-03-02 20:01:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2020/017665_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Dustin Dettmer 2020-03-02 20:01:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017656_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>freedom at reardencode.com 2020-02-27 03:26:07</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017663_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Marko 2020-02-28 17:42:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017660_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>ZmnSCPxj 2020-02-28 13:31:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2020/017664_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Dustin Dettmer 2020-03-02 19:45:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017655_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Stepan Snigirev 2020-02-27 02:59:46</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017656_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>freedom at reardencode.com 2020-02-27 03:26:07</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017660_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>ZmnSCPxj 2020-02-28 13:31:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017662_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Stepan Snigirev 2020-02-28 14:40:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2020/017664_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Dustin Dettmer 2020-03-02 19:45:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2020/017665_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Dustin Dettmer 2020-03-02 20:01:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/March_2020/017664_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Dustin Dettmer 2020-03-02 19:45:02</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017662_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Stepan Snigirev 2020-02-28 14:40:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017663_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Marko 2020-02-28 17:42:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017655_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>Stepan Snigirev 2020-02-27 02:59:46</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2020/017660_Nonce-blinding-protocol-for-hardware-wallets-and-airgapped-signers.html">Nonce blinding protocol for hardware wallets and airgapped signers</a>
                        <b>ZmnSCPxj 2020-02-28 13:31:29</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-February/017655.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2020-02-27T02:59:46+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The article discusses the potential compromise of hardware wallets and air-gapped computers used for signing transactions, highlighting that they can be attacked through supply chain attacks or malicious firmware updates. To fix this issue, a protocol is suggested for signing a message `m` which involves the host picking a random number `n`, sending it to the signer along with the hash of the message `m`, and then the signer computing a nonce `k`. It is highlighted that using a deterministic scheme would be unsafe in certain scenarios. Therefore, all data coming from the host should be used to create a nonce. If multiple blinding factors are sent, they should all be used as well. While completely-random nonces would be better, it may not always be possible to gather sufficient entropy. Deterministic nonce generation is vulnerable to glitch attacks, where two identical messages can produce different signatures due to a flipped bit in the message. To prevent this, a monotonic counter should be included in the nonce generation function.The proposed protocol can be implemented for PSBT using key-value pairs added to BIP-174. The article provides an implementation guide for PSBT using key-value pairs and proposes four keys: PSBT_IN_EXT_NONCE_HASH, PSBT_IN_NONCE_COMMITMENT, PSBT_IN_NONCE_SIGNER_METADATA, and PSBT_IN_EXT_NONCE_PREIMAGE. The writer suggests using a generalized sign-to-contract scheme in PSBT as well. They are interested in seeing widespread support for this protocol and standardizing it would help with that. Stepan Snigirev has proposed an extension to the protocol, which involves the use of additional entropy from multiple hosts. The writer seeks feedback on the proposal and whether it would be interesting to have this protocol standardized and deployed. However, there is also increased danger in implementing the protocol wrongly when using PSBT with an air-gapped signer. The PSBT must be verified carefully against state stored by the host for the PSBT; otherwise, the signer can change or pre-fill the relevant NONCE fields and leak the private keys anyway. The writer seeks information on the current best practice for identifying a PSBT by the host to store/retrieve the state. Additionally, the writer asks if there are other examples in PSBT where the host cannot trust the contents of the PSBT that the signer returns, except for the parts the user can verify themselves. Finally, guidelines or conventions on how to avoid these pitfalls would be helpful.The article also proposes a protocol for signing a message that involves the host picking a random number and sending its hash together with the message to the signer, who then computes a nonce they want to use for signing. They commit to the chosen nonce by sending the corresponding point to the host, who then sends the preimage back to the signer before tweaking the nonce and sending back the signature. Hosts verify that the public point in the signature is tweaked by the same amount. The article also suggests that if the signer wants to generate a nonce non-deterministically but doesn't have the ability to store it, they may send meta-information back to the host that would help them regenerate the same nonce later.The proposed protocol has been tested with BitBox02 hw wallet firmware and BitBoxApp wallet. The writer expresses gratitude for the initiative of implementing and releasing a protocol, which was inspired by a blog post on the topic.</p>
        <hr>
        <p><i>Updated on: 2023-06-13T23:51:13.948915+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>