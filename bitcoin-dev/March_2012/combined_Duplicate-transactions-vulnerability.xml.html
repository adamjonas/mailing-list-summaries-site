<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Duplicate transactions vulnerability <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
    <ul>
        
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001265_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-28 16:48:39</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001290_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-03-02 01:56:34</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001287_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Gregory Maxwell 2012-03-01 14:27:53</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001277_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-29 16:47:48</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001267_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-28 17:18:12</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001299_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-03-03 16:41:03</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001288_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-03-01 14:30:30</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001284_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-29 23:45:59</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001281_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Matt Corallo 2012-02-29 22:38:13</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001272_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-28 20:24:15</b>
        </li>
        

        
    </ul>
    
        <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-February/001265.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
    
    <p><i>Published on: 2012-02-28T16:48:39+00:00</i></p>
    <hr>
    <h3> Summary:</h3>
    <p>A security vulnerability has been found in the Bitcoin reference client. The issue is with how the client deals with duplicate transactions. Pieter Wuille, a Bitcoin developer, has proposed an update to fix the issue. His proposal adds an extra protocol rule that blocks cannot contain a transaction whose hash is equal to a former transaction that has not yet been completely spent. This change is backward compatible and has been tested and verified to make the attack impossible.While the patch addresses the vulnerabilities, two potential weaknesses were identified. One requires reverting a chain of at least 120 blocks long, while the other causes a risk for chain split. To address these issues, the patch has been updated.Duplicate coinbase transactions are possible, but they are not accidental. Transactions that spend duplicates can have the same hash as well. Disallowing duplicate coinbases entirely would prevent pruning, but it was suggested that adding the block height to the coinbase could be a reasonable solution. However, this would be harder to roll out network-wide. Hence, the "emergency" solution is to prevent all practical attacks, and in a later step, force unique coinbases so that transactions can be assumed to be uniquely identifiable by their hash again.There is a concern that if only 50% of hashing power adopts BIP30, but the actual client install base is relatively low, the patch will likely result in a "hard" blockchain split if someone takes advantage. A malicious miner could produce a duplicate coinbase, which the majority of clients will accept, but the majority of hashing power won't. Spending the coinbase output after disconnection will cause the blockchain to fork. All non-BIP30 clients on the short blockchain will be vulnerable to transaction reversal of six confirmations or more. It is a relatively inexpensive attack to perform, costing the attacker only one valid block ~$240, and could be quite disruptive. Therefore, they suggest patching in DisconnectBlock() before any protocol change with a new mapByCoinbase multimap.The proposed update is to be rolled out by March 15, and Pieter Wuille has asked for support for adding this rule to the protocol rules. If there is consensus that this rule is the solution, he hopes pools and miners can agree to update their nodes without a lengthy coinbase-flagging procedure that would only delay a solution.</p>
    <hr>
    <p><i> Updated on: 2023-05-19T01:10:18.495946+00:00 </i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>