<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Duplicate transactions vulnerability <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
    <ul>
        
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001265_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-28 16:48:39</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001290_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-03-02 01:56:34</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001287_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Gregory Maxwell 2012-03-01 14:27:53</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001277_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-29 16:47:48</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001267_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-28 17:18:12</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001299_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-03-03 16:41:03</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/March_2012/001288_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-03-01 14:30:30</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001284_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-29 23:45:59</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001281_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Matt Corallo 2012-02-29 22:38:13</b>
        </li>
        
        <li>
        <a href="/bitcoin-dev/Feb_2012/001272_Duplicate-transactions-vulnerability.xml.html">Duplicate transactions vulnerability</a>
        <b>Pieter Wuille 2012-02-28 20:24:15</b>
        </li>
        

        
    </ul>
    
        <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-February/001265.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
    
    <p><i>Published on: 2012-02-28T16:48:39+00:00</i></p>
    <hr>
    <h3> Summary:</h3>
    <p>Pieter Wuille, a Bitcoin developer, has discovered a vulnerability in the way the Bitcoin reference client deals with duplicate transactions. The issue requires significant hash power to exploit and does not offer any financial gain to attackers; however, it is still a security hole that needs to be fixed.To address this issue, Wuille proposed adding an extra protocol rule: "Do not allow blocks to contain a transaction whose hash is equal to that of a former transaction which has not yet been completely spent." He created patches for various versions of Bitcoin clients and asked pool operators, miners, and pool operators to upgrade their nodes to avoid blockchain corruption issues.Wuille also proposed that if a supermajority of mining power implements the change, old clients can continue to function without risk. Wuille asked for support from pools and miners to update their nodes as soon as possible, without a lengthy coinbase-flagging procedure that would delay a solution. The proposed fix is to not allow blocks to contain transactions whose hash is equal to that of a former transaction which has not yet been completely spent. This change is backward compatible in the same way as BIP16. A patch for the reference client has been tested and verified to make the attack impossible. However, after some private discussions, two potential small weaknesses in the proposed patch were pointed out, and Pieter Wuille updated the patch. Ben Reeves suggested moving the check for dupes up, turning the new network rule into: "Blocks are not allowed to contain transactions whose hash matches that of an earlier transaction in the same chain unless that transaction was already completely spent before said block." Duplicate coinbase transactions are possible but not likely to happen by accident. Transactions that spend duplicate coinbases can be made to have the same hash as well.If 50% of hashing power adopts BIP30 but the actual client install base is relatively low, the patch will likely result in a hard blockchain split if someone takes advantage. A malicious miner can produce a duplicate coinbase that most clients will accept but the majority of hashing power won't, and spending the coinbase output after disconnection will cause the blockchain to fork. All none BIP30 clients on the short blockchain will be vulnerable to transaction reversal of six confirmations or more.</p>
    <hr>
    <p><i> Updated on: 2023-05-18T23:35:39.726120+00:00 </i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>