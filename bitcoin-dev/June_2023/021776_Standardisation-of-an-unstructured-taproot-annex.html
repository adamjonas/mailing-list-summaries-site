<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Antoine Riard 2023-06-19 01:14:10+00:00
            <br><i>Published on: 2023-06-19T01:14:10+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021776.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard is seeking clarification on the opt-in mechanism mentioned by Joost Jager regarding non-deployed and deployed protocols. Antoine mentions scenarios where witness inflation could occur and the need to commit to a new annex policy to avoid future interferences. He questions whether adding an annex for non-deployed protocols is necessary, as currently deployed protocols can be opted-in through script spend path in collaborative added inputs. Greg Sanders responds, stating that protocols should not be built on undeveloped upgrade hooks and requests a citation for the mentioned opt-in mechanism. Antoine acknowledges that ideally, they should not be encumbered by premature choices but highlights cases where the coordination cost of deploying a new policy might be prohibitive. He emphasizes the importance of sound and "firewalled" signaling and upgrading mechanisms to deploy new policy rules for new use-cases smoothly.In a separate email, Greg asks for a citation regarding the requirement to modify current Taproot support for Lightning-side P2TR spends. He expresses his view that protocols meant for production should not be built on undeveloped upgrade hooks. Antoine clarifies the requirement, stating that all P2TR spends on the Lightning side must add an annex and commit to it in the BIP341 signature digest. He explains that this mandatory upgrade for Lightning nodes is crucial to prevent the propagation of broken `option_taproot` channel transactions.Antoine also discusses the proposal to limit the maximum size of the value to 256 bytes as a means to protect opt-in users. He mentions another approach involving introducing the maximum size/weight of the witness/transaction as a TLV record itself. He references a branch that implements the "only allow tlv record 0" with the TLV format from BIP #1381.Joost Jager joins the conversation and suggests a restrictive policy that would enable annex-vaults and align with existing work. The proposed policy includes opt-in annex for every input, tlv format as defined in a GitHub pull request, only allowing tlv record 0 for unstructured data, and limiting the maximum size of the value to 256 bytes. Joost highlights that the current limit of 126 bytes in a pull request is insufficient for certain vaults and explains the need for additional space for signatures and other parameters. He asks for any remaining practical objections to making the annex standard under the listed conditions.Overall, the discussion focuses on the opt-in mechanism, the modification of Taproot support for Lightning-side P2TR spends, the need for protective measures for opt-in users, and proposals for policies related to annex-vaults and TLV formats.</p>
    <hr>
    <p><i> Updated on: 2023-07-03T02:43:29.895780+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>