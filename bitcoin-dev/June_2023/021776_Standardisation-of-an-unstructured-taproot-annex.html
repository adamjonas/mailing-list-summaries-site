<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Antoine Riard 2023-06-19 01:14:10+00:00
            <br><i>Published on: 2023-06-19T01:14:10+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021776.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a discussion between Greg and Antoine, the topic of opt-in annexes for protocols in Bitcoin was raised. Antoine questioned whether the opt-in mechanism would apply to non-deployed protocols or already deployed ones. He mentioned scenarios like pre-signed vaults and coinjoin/lightning spending P2TR outputs, where witness inflation could occur. Antoine suggested that if the opt-in mechanism only applies to non-deployed protocols, then existing protocols can still be opted-in through script spend path in the context of collaborative added inputs.Greg responded by stating that people should not build protocols meant for production on undeveloped upgrade hooks. He requested a citation for clarification. Antoine acknowledged that premature choices should be avoided ideally, but if these use-cases gain economic weight, deploying a new policy might be costly or time-consuming. He argued for upgrading mechanisms that allow smoother deployment of new policy rules for new use-cases.Greg expressed confusion about modifying Taproot support on the Lightning-side and emphasized the importance of citations to prevent premature encumbrances. Antoine explained that requiring P2TR spends to add an annex and commit to it in the BIP341 signature digest would be a mandatory upgrade for Lightning nodes. Failure to do so would disrupt propagations of `option_taproot` channel transactions.Antoine also mentioned another approach where the maximum size/weight of the witness/transaction is introduced as a TLV record itself. He provided a link to a GitHub branch that implements this approach along with the "only allow tlv record 0" using the TLV format from BIP #1381.The discussion continued with Joost suggesting a restrictive policy that enables annex-vaults and aligns with previous work. The proposed policy includes an opt-in annex for every input, the use of TLV format for future extensibility, only allowing unstructured data (tlv record 0) for future extensibility, and limiting the maximum size of the value to 256 bytes to protect opt-in users. Joost pointed out that the previous limit of 126 bytes in a GitHub pull request is insufficient for certain vault scenarios.Overall, the discussion revolves around the concept of opt-in annexes for protocols in Bitcoin, potential impacts on existing and future protocols, and the need for careful consideration and coordination in deploying new policy rules.</p>
    <hr>
    <p><i> Updated on: 2023-07-13T02:44:52.208929+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>