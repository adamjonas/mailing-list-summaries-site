<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Greg Sanders 2023-06-18 20:40:53+00:00
            <br><i>Published on: 2023-06-18T20:40:53+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021774.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard had a question regarding the requirement for every input to commit to an annex, even if it is empty. He asked if this meant rejecting a transaction where the minimal annex with its 0x50 tag is absent. He also mentioned that this requirement would require modifying the current Taproot support on the Lightning side, where all P2TR spends must add an annex and commit to it in the BIP341 signature digest. This would be a mandatory upgrade for Lightning nodes, as failure to do so would break propagations of their `option_taproot` channel transactions.There was another approach mentioned by Antoine, where the maximum size/weight of the witness/transaction is introduced as a TLV record itself. He provided a link to a branch implementing this approach, which also implements the "only allow tlv record 0" with the TLV format from BIP #1381.Greg Sanders responded to Joost Jager's question about whether it would still be necessary to restrict the annex to a maximum size. Greg stated that he thinks it's worth thinking about to protect the opt-in users and can also be used for other anti-pinning efforts. He mentioned that it can be further relaxed in the future if they decide to use max tx size policy "hints" in an annex field.Joost Jager outlined a set of policies that would enable annex-vaults while protecting opt-in users and remaining in line with the work already done. These policies include opt-in annex, Tlv format, only allowing tlv record 0, and limiting the maximum size of the value to 256 bytes. However, Joost noted that the limit of 126 bytes proposed in a previous pull request isn't sufficient for these types of vaults. He explained that if there are two presigned transactions (unvault and emergency), those signatures would already take up 128 bytes, and additional space would be needed for the ephemeral key and other vault parameters.Overall, the discussion revolves around the requirements and potential modifications needed for Taproot support on the Lightning side, the introduction of an annex for every input, and the policies to protect opt-in users and enable annex-vaults.</p>
    <hr>
    <p><i> Updated on: 2023-06-28T02:41:52.976949+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>