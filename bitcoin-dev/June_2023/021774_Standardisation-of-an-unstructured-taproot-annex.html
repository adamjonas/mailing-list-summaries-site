<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Greg Sanders 2023-06-18 20:40:53+00:00
            <br><i>Published on: 2023-06-18T20:40:53+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021774.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard raised a question regarding the requirement for every input to commit to an annex, even if it is empty, in the context of Taproot support on the Lightning-side. This would necessitate modifying the current Taproot support, specifically for P2TR spends, where the annex needs to be added and committed to in the BIP341 signature digest. Antoine suggests that this mandatory upgrade for Lightning nodes could potentially break propagations of their `option_taproot` channel transactions. There is another approach proposed, which involves introducing the maximum size/weight of the witness/transaction as a TLV record itself. This approach is discussed in a pull request (<a href="https://github.com/bitcoin-inquisition/bitcoin/pull/28),">https://github.com/bitcoin-inquisition/bitcoin/pull/28),</a> which also implements the "only allow tlv record 0" with the TLV format from bips #1381. Greg Sanders supports considering the restriction of the annex size to protect opt-in users and potentially address pinning vectors. However, he mentions that this alone may not be sufficient for all pinning vectors. Greg believes that using max tx size policy "hints" in an annex field could provide further flexibility in the future.Joost Jager suggests a set of policies for annex-vaults that are in line with existing work. These policies include an opt-in annex for every input, a Tlv format as defined in <a href="https://github.com/bitcoin/bips/pull/1381">https://github.com/bitcoin/bips/pull/1381</a> for future extensibility, allowing only tlv record 0 for unstructured data, and limiting the maximum size of the value to 256 bytes to protect opt-in users. Joost notes that the current limit of 126 bytes in a pull request (<a href="https://github.com/bitcoin-inquisition/bitcoin/pull/22)">https://github.com/bitcoin-inquisition/bitcoin/pull/22)</a> is not sufficient for these types of vaults because of the need to store multiple presigned transactions and other vault parameters. Overall, there are ongoing discussions and considerations regarding the requirements and policies related to annexes and maximum size restrictions in the context of Taproot support, Lightning nodes, and opt-in users.</p>
    <hr>
    <p><i> Updated on: 2023-07-09T02:49:08.156689+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>