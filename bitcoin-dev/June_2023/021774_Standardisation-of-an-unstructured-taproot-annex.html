<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Greg Sanders 2023-06-18 20:40:53+00:00
            <br><i>Published on: 2023-06-18T20:40:53+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021774.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard and Greg Sanders are discussing the implementation of an opt-in annex feature for Taproot support on the Lightning side. Antoine mentions that every input must commit to an annex, even if it is empty. This would require modifying the current Taproot support on the Lightning-side, where all P2TR spends must add an annex and commit to it in the BIP341 signature digest. Failure to do so would break propagations of `option_taproot` channel transactions. Greg expresses his confusion about the requirement and requests a citation for clarification. He emphasizes that protocols should not be built on undeveloped upgrade hooks and premature choices should not encumber them. Antoine responds by explaining that the requirement means rejecting a transaction where the minimal annex with its 0x50 tag is absent. He also suggests an alternative approach where the maximum size/weight of the witness/transaction is introduced as a TLV record. He provides a link to a branch that implements this approach and the "only allow tlv record 0" with the TLV format from BIPs #1381.In a separate email, Greg discusses the possibility of restricting the annex to a maximum size to protect opt-in users and potentially address anti-pinning efforts. Joost Jager proposes a set of policies for opt-in annex-vaults, including an opt-in annex for every input, a TLV format as defined in BIPs #1381, only allowing tlv record 0 for unstructured data, and limiting the maximum size of the value to 256 bytes to protect opt-in users. However, there is a concern that the limit of 126 bytes proposed in a previous pull request is insufficient for these types of vaults. Joost asks for any remaining practical objections to making the annex standard under the specified conditions.Overall, the discussion revolves around the implementation and potential implications of the opt-in annex feature for Taproot support on the Lightning side. There are concerns about the mandatory upgrade for Lightning nodes and the need for further clarification and consideration of the proposed policies.</p>
    <hr>
    <p><i> Updated on: 2023-07-10T02:45:04.970286+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>