<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Greg Sanders 2023-06-18 20:40:53+00:00
            <br><i>Published on: 2023-06-18T20:40:53+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021774.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard raised a question regarding the requirement of every input to commit to an annex, even if it is empty. He asked for clarification on whether the absence of the minimal annex with its 0x50 tag would result in rejecting a transaction. This modification would be necessary for Taproot support on the Lightning-side, as all P2TR spends must add an annex and commit to it in the BIP341 signature digest. This would require a mandatory upgrade for Lightning nodes to ensure the propagation of their `option_taproot` channel transactions remains unbroken.Another approach to protect opt-in users is by limiting the maximum size/weight of the witness/transaction to 256 bytes. There is a branch that implements this approach by introducing the maximum size/weight of the witness/transaction as a TLV record itself. This branch also implements the "only allow tlv record 0" with the TLV format from BIP #1381.Greg Sanders responded to Joost Jager's question about whether it would still be necessary to restrict the annex to a maximum size. Greg mentioned that considering the most restrictive policy is worth thinking about to protect opt-in users and can also be used for other anti-pinning efforts. He suggested using max tx size policy "hints" in an annex field to further relax the restrictions in the future.Joost Jager outlined a set of policies that would enable annex-vaults while ensuring compatibility with existing multi-party protocols and allowing for future extensibility. The policies include opt-in annexes, the use of the TLV format defined in BIP #1381, only allowing tlv record 0 for unstructured data, and limiting the maximum size of the value to 256 bytes. However, Joost noted that the current limit of 126 bytes proposed in a pull request is not sufficient for certain vault scenarios, such as having two presigned transactions and storing the ephemeral key. Joost asked for any remaining practical objections to making the annex standard under these conditions.Overall, there are discussions and considerations being made regarding the modification of Taproot support on the Lightning-side, the limitation of annex size, and the implementation of TLV format and policies to protect opt-in users and enable future extensibility.</p>
    <hr>
    <p><i> Updated on: 2023-07-06T02:45:09.091821+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>