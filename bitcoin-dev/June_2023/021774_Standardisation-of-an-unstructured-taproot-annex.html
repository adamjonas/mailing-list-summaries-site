<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Greg Sanders 2023-06-18 20:40:53+00:00
            <br><i>Published on: 2023-06-18T20:40:53+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021774.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Antoine Riard reached out to the bitcoin-dev mailing list to clarify a statement made by Joost Jager regarding the opt-in annex for Bitcoin protocol. Antoine questioned whether rejecting a transaction without the minimal annex with its 0x50 tag would be required. He pointed out that implementing this change would necessitate modifying current Taproot support on the Lightning side, where all P2TR spends must add an annex and commit to it in the BIP341 signature digest. Failure to upgrade Lightning nodes accordingly would disrupt the propagation of their `option_taproot` channel transactions. In addition, Antoine mentioned an alternative approach where the maximum size/weight of the witness/transaction is introduced as a TLV record itself.Greg Sanders responded to Joost's suggestion, stating that he hadn't given much thought to the specific TLV format but believed it could be a reasonable starting point. He noted that it wouldn't unduly impact current users and would be simple from an accounting perspective. Greg also mentioned the possibility of relaxing the TLV format in the future by using max tx size policy "hints" in an annex field.Joost Jager proposed a set of policies for the opt-in annex that would enable annex-vaults while ensuring compatibility with existing multi-party protocols. These policies included requiring every input to commit to an annex (even if empty), implementing the TLV format defined in BIP #1381 for future extensibility, allowing only unstructured data in tlv record 0 for future extensibility, and limiting the maximum size of the value to 256 bytes to protect opt-in users. However, Joost noted that the current limit of 126 bytes proposed in a pull request was insufficient for certain use cases involving vaults with presigned transactions and additional parameters.The discussion highlighted the need to further consider the opt-in annex and its restrictions to ensure the smooth implementation of Bitcoin protocol upgrades while protecting users.</p>
    <hr>
    <p><i> Updated on: 2023-06-30T02:31:40.353935+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>