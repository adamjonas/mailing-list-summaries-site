<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Antoine Riard 2023-06-18 20:32:12+00:00
            <br><i>Published on: 2023-06-18T20:32:12+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021775.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The discussion revolves around the implementation of an opt-in annex and a maximum size limit for annexes in Bitcoin transactions. The opt-in annex requires every input to commit to an annex, even if it is empty, to ensure that existing multi-party protocols are unaffected. This would require modifying current Taproot support on the Lightning-side, as all P2TR spends must add an annex and commit to it in the BIP341 signature digest. Failure to do so would break propagations of `option_taproot` channel transactions.Another approach suggested is limiting the maximum size/weight of the witness/transaction to 256 bytes to protect opt-in users. This approach is proposed in a pull request (<a href="https://github.com/bitcoin-inquisition/bitcoin/pull/28)">https://github.com/bitcoin-inquisition/bitcoin/pull/28)</a> that also implements the "only allow tlv record 0" with the TLV format from bips #1381.Greg Sanders suggests that the TLV format is a reasonable place to start and should not unduly impact current users. He also mentions the possibility of using max tx size policy "hints" in an annex field to further relax the restrictions in the future. Joost Jager proposes a set of policies that would enable annex-vaults and align with existing work. These policies include the opt-in annex, Tlv format from bips #1381, allowing only tlv record 0 for unstructured data, and limiting the maximum size of the value to 256 bytes. However, he notes that the current limit of 126 bytes in a pull request (<a href="https://github.com/bitcoin-inquisition/bitcoin/pull/22)">https://github.com/bitcoin-inquisition/bitcoin/pull/22)</a> is insufficient for these types of vaults, as there may be multiple presigned transactions and additional parameters that need to be stored.Overall, the discussion focuses on finding a balance between protecting opt-in users and enabling future extensibility while ensuring the practicality of implementing these policies.</p>
    <hr>
    <p><i> Updated on: 2023-06-28T02:41:06.868914+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>