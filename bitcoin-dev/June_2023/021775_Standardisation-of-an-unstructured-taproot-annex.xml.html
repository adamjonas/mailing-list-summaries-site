<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Antoine Riard 2023-06-18 20:32:12+00:00
            <br><i>Published on: 2023-06-18T20:32:12+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021775.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>A proposal has been made to require every input to commit to an annex even if it is empty, which would mean rejecting a transaction where the minimal annex with its 0x50 tag is absent. This change would require modifying current Taproot support on the Lightning-side, as all P2TR spends must add an annex and commit to it in the BIP341 signature digest. This could potentially be a mandatory upgrade for Lightning nodes, as failure to do so would break propagations of their `option_taproot` channel transactions. Another approach to protecting opt-in users is to limit the maximum size/weight of the witness/transaction to 256 bytes. However, there is another proposal to introduce the maximum size/weight of the witness/transaction as a TLV record itself. This branch also implements the "only allow tlv record 0" with the TLV format from bips #1381. It's suggested that this approach would not unduly impact current users, and is pretty simple from an accounting perspective. It can also be further relaxed in the future if we so decide by using max tx size policy "hints" in an annex field. Overall, the proposal includes an opt-in annex, Tlv format, only allowing tlv record 0, and limiting the maximum size of the value to 256 bytes to protect opt-in users. The limit of 126 bytes proposed in another pull request isn't sufficient for these types of vaults. If there are two presigned txes (unvault and emergency), those signatures would already take up 2*64=128 bytes. Then you also want to store 32 bytes for the ephemeral key itself as the key can't be reconstructed from the schnorr signature.</p>
    <hr>
    <p><i> Updated on: 2023-06-22T01:14:27.712042+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>