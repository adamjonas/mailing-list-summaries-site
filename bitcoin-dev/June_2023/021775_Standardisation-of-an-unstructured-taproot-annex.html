<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Standardisation of an unstructured taproot annex</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Antoine Riard 2023-06-18 20:32:12+00:00
            <br><i>Published on: 2023-06-18T20:32:12+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2023/combined_Standardisation-of-an-unstructured-taproot-annex.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2023-June/021775.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The discussion revolves around the implementation of an opt-in annex and limiting the maximum size of the value in Bitcoin transactions. The first point raised is the requirement for every input to commit to an annex, even if it is empty. This would involve modifying the current Taproot support on the Lightning-side, where all P2TR spends must add an annex and commit to it in the BIP341 signature digest. Failure to do so would break propagations of `option_taproot` channel transactions.Another approach suggested is to introduce the maximum size/weight of the witness/transaction as a TLV (Type Length Value) record itself. A GitHub branch (<a href="https://github.com/bitcoin-inquisition/bitcoin/pull/28)">https://github.com/bitcoin-inquisition/bitcoin/pull/28)</a> is mentioned that implements this approach and also includes the implementation of "only allow tlv record 0" with the TLV format from BIP #1381.In response to this suggestion, Greg Sanders agrees that using the TLV format seems reasonable and should not unduly impact current users. He suggests that max tx size policy "hints" in an annex field can be used to further relax the restrictions in the future.Joost Jager brings up the need to restrict the annex to a maximum size to protect opt-in users. He proposes a set of policies that include the opt-in annex, the TLV format, allowing only unstructured data in tlv record 0, and limiting the maximum size of the value to 256 bytes. However, he points out that the current limit of 126 bytes in a GitHub pull request (<a href="https://github.com/bitcoin-inquisition/bitcoin/pull/22)">https://github.com/bitcoin-inquisition/bitcoin/pull/22)</a> is insufficient for certain use cases involving annex-vaults. He explains that if there are two presigned transactions (unvault and emergency), their signatures alone would take up 128 bytes, and additional space is needed for the ephemeral key and other vault parameters.Joost seeks input on any remaining practical objections to making the annex standard under the conditions listed above.Overall, the discussion focuses on the technical considerations and potential implications of implementing an opt-in annex and limiting the maximum size of the value in Bitcoin transactions. The participants explore different approaches and discuss their potential impact on existing protocols and users.</p>
    <hr>
    <p><i> Updated on: 2023-07-01T02:55:13.187892+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>