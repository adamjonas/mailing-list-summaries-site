<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>BIP draft: OP_CHECKBLOCKATHEIGHT</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Tom 2016-09-24 09:37:52
            <br><i>Published on: 2016-09-24T09:37:52+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Sept_2016/combined_BIP-draft-OP-CHECKBLOCKATHEIGHT.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-September/013167.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a discussion on the Bitcoin-dev mailing list, Luke Dashjr proposed a new opcode called OP_CHECKBLOCKATHEIGHT that would address reissuing bitcoin transactions when the coins they spend have been conflicted or double-spent. Tom asked for a real-life use case where this solves a problem, but it was pointed out that the scenario assumed so many stupid mistakes from software and people that it's unlikely to happen. The proposed solution requires the victim to suddenly be super smart and use a solution specifically designed for this unlikely use case. Luke responded with an example where Joe sends Alice 5 BTC, Fred sends Alice 4 BTC, Alice sends Bob 4 BTC using UTXO 1 (creating UTXO 2), and Fred double-spends UTXO 1 with UTXO 1-B, invalidating Alice's transfer to Bob. Alice has UTXO 0 which she can send to Bob (UTXO 3), but if she does so, it is possible that UTXO 0 could be mined, resulting in her giving Bob a total of 8 BTC rather than merely 4 BTC. Using OP_CHECKBLOCKATHEIGHT, however, Alice can create UTXO 3 such that it is valid only in the blockchain where Fred's UTXO 1-B has confirmed. This way, if that block is reorganized out, UTXO 3 is invalid, and either Bob receives only the original UTXO 2 or Alice can create a UTXO 3-B which is valid in the reorganized blockchain if it confirms the UTXO 1-B double-spend again.</p>
    <hr>
    <p><i> Updated on: 2023-06-11T20:06:55.198360+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>