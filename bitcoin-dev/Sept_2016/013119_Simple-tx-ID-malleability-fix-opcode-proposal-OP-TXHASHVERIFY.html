<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Simple tx ID malleability fix, opcode proposal: OP_TXHASHVERIFY</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Nick ODell 2016-09-17 22:34:43
            <br><i>Published on: 2016-09-17T22:34:43+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Sept_2016/combined_Simple-tx-ID-malleability-fix-opcode-proposal-OP-TXHASHVERIFY.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-September/013119.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The discussion thread on the bitcoin-dev mailing list revolves around creating transactions that are immune to transaction ID malleability. Rune K. Svendsen proposed a solution called OP_TXHASHVERIFY, which could be added to a scriptSig as the very first operation and would abort if the hash of the transaction with all OP_TXHASHVERIFY operations (including stack push) removed does not match what has been pushed on the stack. This would add 34 bytes per input for each input you wish to protect against tx ID malleability. However, Matt Corallo pointed out that the tx hash in the construction is not signed, which means someone wishing to manipulate a transaction may do so by also updating the hash in the scriptSig. Nick raised another issue that Hash1 must contain Hash2 and the transaction, but Hash2 must contain Hash1 and the transaction - a circular dependency. Rune replied that there is a solution, but it makes the operation less simple. If a transaction contains at least two OP_TXHASHVERIFY-protected inputs, signed without ANYONECANPAY, their signatures would cover the other input's OP_TXHASHVERIFY hash. The proposed solution is simple and valuable to not worry about tx ID malleability until something better becomes available, such as Segwit.</p>
    <hr>
    <p><i> Updated on: 2023-06-11T20:00:06.723750+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>