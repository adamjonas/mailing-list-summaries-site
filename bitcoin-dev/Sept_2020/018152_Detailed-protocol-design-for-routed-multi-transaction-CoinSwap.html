<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Detailed protocol design for routed multi-transaction CoinSwap</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> ZmnSCPxj 2020-09-03 09:45:53
            <br><i>Published on: 2020-09-03T09:45:53+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Sept_2020/combined_Detailed-protocol-design-for-routed-multi-transaction-CoinSwap.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2020-September/018152.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>A vulnerability in the CoinSwap system has been found that could lead to privacy leaks. The vulnerability is called the riskless theft attempt problem, where a previous owner of coins knows the fully-signed contract transaction and can broadcast it at no cost to themselves. To solve this problem, collateral payments are proposed where there is a 2of2 multisig made up of Bob's and Charlie's keys. The value K is something that can be set by the protocol, and made high enough so that doing a riskless theft attempt is not worth it. A fresh maker that is given its starting funds in a single UTXO needs to split up its funds to make at least one collateral input it can use. In terms of onchain analysis heuristics, the B output also serves as a point for CPFPing this transaction, thus only one version of the B collateralized contract transaction needs to be made, and the B collateralized contract transaction can be at or close to the minimum relay feerate and later CPFPed. The other contract transaction, known only to Charlie, does not contain a collateral input or collateral value (K), because Charlie can't do a riskless theft attempt to Bob. If Bob ever spends his collateral input in another transaction, then his contract transaction will become invalid.</p>
    <hr>
    <p><i> Updated on: 2023-06-14T03:23:57.933675+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>