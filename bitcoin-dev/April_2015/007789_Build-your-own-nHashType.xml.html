<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Build your own nHashType</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Gregory Maxwell 2015-04-15 03:34:50
            <br><i>Published on: 2015-04-15T03:34:50+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/April_2015/combined_Build-your-own-nHashType.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-April/007789.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Stephen Morse proposed a change in the nHashType that would allow transaction signers to specify what is to be serialized for the signature hash. This would make malleability almost a non-issue, and hardware wallets could sign securely without downloading or processing each transaction they spend from. However, there are concerns about creating too many options that rapidly extend into a choose-your-own-adventure with too many options to count. The author of the post suggests that any sighash masking that eliminates the txin txid enables covenants. Covenants are payments that constrain their future payments, like deed covenants. The author explains how this approach can work where the scriptpubkey contains "[push: 0x30, 0x06, 0x02, 0x01, 0x04, 0x02, 0x01, 0x04, flags] [push pubkey resulting from pubkey recovery] OP_CHECKSIG" and set the flags to match only the things you want to enforce in the spending transaction hash them up and recover the EC public point. The author admits that they don't currently see how to get a perpetual covenant out of it; however, they suggest it might be possible with a sufficiently complex sighash flag and nothing else.</p>
    <hr>
    <p><i> Updated on: 2023-05-19T20:02:09.658523+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>