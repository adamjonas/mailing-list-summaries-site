<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Cold Signing Payment Requests <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002448_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Alan Reiner 2013-04-24 23:07:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002449_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 09:08:26</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002450_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 09:58:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002451_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:05:06</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002453_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:45:33</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002455_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 11:55:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002457_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 14:31:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002478_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-30 09:17:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002479_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jouke Hofman 2013-04-30 11:32:54</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002480_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Gavin Andresen 2013-04-30 13:14:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2013/002523_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Peter Todd 2013-05-06 21:29:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002447_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-24 23:01:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002452_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 10:28:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002455_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 11:55:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002459_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Gavin Andresen 2013-04-26 01:07:07</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002477_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-29 18:40:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002478_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-30 09:17:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002479_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jouke Hofman 2013-04-30 11:32:54</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002482_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-30 17:17:23</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002448_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Alan Reiner 2013-04-24 23:07:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002449_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 09:08:26</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002455_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 11:55:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002457_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 14:31:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002458_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-25 19:12:37</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002465_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-28 18:03:04</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002447_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-24 23:01:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002454_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:52:33</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002459_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Gavin Andresen 2013-04-26 01:07:07</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002482_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-30 17:17:23</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002480_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Gavin Andresen 2013-04-30 13:14:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002449_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 09:08:26</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002450_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 09:58:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002453_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:45:33</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002454_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:52:33</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002458_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-25 19:12:37</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002447_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-24 23:01:51</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002450_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 09:58:55</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002451_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:05:06</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002459_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Gavin Andresen 2013-04-26 01:07:07</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002477_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-29 18:40:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002480_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Gavin Andresen 2013-04-30 13:14:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002482_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-30 17:17:23</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2013/002523_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Peter Todd 2013-05-06 21:29:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002477_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-29 18:40:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002452_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 10:28:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002458_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jeremy Spilman 2013-04-25 19:12:37</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002465_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-28 18:03:04</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002448_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Alan Reiner 2013-04-24 23:07:59</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002451_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:05:06</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002457_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 14:31:16</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002465_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-28 18:03:04</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002452_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Timo Hanke 2013-04-25 10:28:53</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002453_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:45:33</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002454_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-25 10:52:33</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002478_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Mike Hearn 2013-04-30 09:17:05</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/April_2013/002479_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Jouke Hofman 2013-04-30 11:32:54</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/May_2013/002523_Cold-Signing-Payment-Requests.xml.html">Cold Signing Payment Requests</a>
                        <b>Peter Todd 2013-05-06 21:29:59</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2013-April/002448.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2013-04-24T23:07:59+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The context discusses various concerns and potential solutions related to the security of pay-to addresses in case a merchant's web server is compromised. One proposed solution involves using x509 certificates to sign payment requests, but this method leaves the signing key exposed to theft. Another proposed solution involves using a custom certificate type that chains onto the end, allowing for delegation and avoiding sharing SSL private keys with third parties. The risk of merchants missing payments or having their refunds redirected are two primary concerns, but reliable payment processing comes at a cost.The discussion revolves around the safety of payment request signing keys and the limitations of SSL PKI. The author argues that there is no payment request signing key that is safer than an SSL key, and it is impossible to have a payment request signing key that is safer than an SSL key due to current CA policies. One way to keep the pay-to address secure is by using a more trusted EV end cert and a less trusted DV end cert. Another way is to get the pubKey into the cert attributes, such as encoding the pubKey or a fingerprint of the pubKey, as a Subject Alternate Name. However, this complicates the merchant's wallet since the payment is going to a pseudo-random address.The Payment Protocol employs x509 certificates to sign a payment request, making it easier for wallets to display metadata from the cert to the payer instead of the address. However, since payment requests must be generated live, the key used to sign them is exposed to theft similar to a hot wallet. The solution is to sign something once with a key kept offline that verifies the address in the payment request belongs to the payee. The author of the post suggested differentiating between "most trusted" and "less trusted" keys, but no certificate authorities (CAs) will issue such certificates.In addition, the use of a payment address as an implicit signature by hashing something and multiplying it into the payee's pubKey has its downsides, such as complicating the merchant's wallet and handling errors when posting to the payment_url. The threat model for signing the refund address is also unclear since the same process that signs the transaction is also doing an HTTPS POST with the refund address. If an attacker can defeat that, they can redirect the payment in the first place.Overall, the context discusses the challenges and potential solutions for keeping payment request signing keys and pay-to addresses secure while working within the limitations of SSL PKI and current CA policies. The threat of a malware-compromised host with a wallet capable of signing transactions and understanding the payment protocol is a real one. Timo's protocol offers a potential solution, but it is unlikely to be implemented at this point due to the feature set for version one being locked down. Other discussions include bottleneck issues in v0.9, protecting payees against a compromised web server, and verifying where money is being sent. Payees can create PaymentDetails messages with an explicit pubkey in output.script, and if payment_url is specified, the payer hashes their Payment message and pays to h*pubkey, where h is the computed hash. Refund address signing should probably be an option that the payer can choose after reading a backup warning. There are also suggestions on how to obtain cryptographic identities through secure channels, such as signing the key list under one's legal identity or checking revocation lists. Peter Todd emphasizes the importance of public disclosure to ward off potential patent threats in the future and suggests archiving key documentation like forum development sections, email list archives, and IRC logs on archive.org.</p>
        <hr>
        <p><i>Updated on: 2023-06-06T15:40:22.205109+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>