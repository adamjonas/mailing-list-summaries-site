<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Safer sighashes and more granular SIGHASH_NOINPUT</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Rusty Russell 2018-12-20 23:17:15
            <br><i>Published on: 2018-12-20T23:17:15+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/Dec_2018/combined_Safer-sighashes-and-more-granular-SIGHASH-NOINPUT.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-December/016576.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The discussion revolves around the use of OP_CODESEPARATOR and its relevance in taproot. The argument is that OP_CODESEPARATOR may not be necessary as it can make scripts more complex and no wallet requires it. However, there is a proposal that suggests using the new sighash to always commit to the same H(script) instead of truncated scriptCode so that hashing only needs to be done once even if the script is very large. This proposal could be useful for NOINPUT with MASKEDSCRIPT, which will commit to the H(masked_script) instead of H(script). The semantics of CODESEPARATOR do not change as the sighash also commits to the position of the last executed CODESEPARATOR, making it still work for scripts without CODESEPARATOR. However, if NOINPUT does not commit to H(masked_script), it could still commit to the position of the last executed CODESEPARATOR but may be unreliable and non-useful except for "I reused keys for multiple outputs" oops.</p>
    <hr>
    <p><i> Updated on: 2023-06-13T15:26:14.799583+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>