<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Full Disclosure: Denial of Service in STONEWALLx2 (p2p coinjoin)</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> alicexbt 2022-07-14 09:25:56
            <br><i>Published on: 2022-07-14T09:25:56+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/July_2022/combined_Full-Disclosure-Denial-of-Service-in-STONEWALLx2-p2p-coinjoin-.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2022-July/020737.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Samourai Wallet's p2p coinjoin transaction, STONEWALLx2, splits the miner fee between both participants of the transaction. However, Antoine Riard shared the details of a denial-of-service (DoS) attack in an email on June 21, 2022. The attack was carried out by one participant preventing the other from completing the transaction. In his proof of concept, he created a testnet wallet and used two Android devices to simulate Bob and Carol, who followed each other's paynyms. Carol initiated several paynyms and when Bob initiated a STONEWALLx2 transaction that required collaboration with Carol, she spent the UTXO from her wallet before Bob could complete the last step. This caused an error message to appear on Bob's app when trying to broadcast the transaction.The Samourai Wallet team came up with two suggestions to prevent such attacks. First, they proposed an error message that states collaborator spent her UTXO used in STONEWALLx2, end the p2p coinjoin process, unfollow collaborator's paynym and suggest user to do such transactions with trusted users only for a while. Second, once full RBF is used by some nodes and miners, attacker's transaction could be replaced with a higher fee rate. However, bumping the fee won't be simple as fees are shared 50/50 for STONEWALLx2 spends.The timeline shows that the issue was acknowledged by Samourai on July 7, 2022, and conclusions were shared on July 14, 2022. Antoine Riard discovered the DoS vector in p2p coinjoin transactions and helped by responding to emails during testing.</p>
    <hr>
    <p><i> Updated on: 2023-05-22T20:45:43.086944+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>