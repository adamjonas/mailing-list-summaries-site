<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Full Disclosure: CVE-2012-2459 (block merkle calculation exploit) <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001807_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Luke-Jr 2012-08-22 02:53:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001808_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Mike Hearn 2012-08-22 08:10:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001808_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Mike Hearn 2012-08-22 08:10:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001806_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Forrest Voight 2012-08-22 02:25:20</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001806_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Forrest Voight 2012-08-22 02:25:20</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001807_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Luke-Jr 2012-08-22 02:53:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001808_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Mike Hearn 2012-08-22 08:10:29</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001806_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Forrest Voight 2012-08-22 02:25:20</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Aug_2012/001807_Full-Disclosure-CVE-2012-2459-block-merkle-calculation-exploit-.html">Full Disclosure: CVE-2012-2459 (block merkle calculation exploit)</a>
                        <b>Luke-Jr 2012-08-22 02:53:21</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2012-August/001807.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2012-08-22T02:53:21+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>A vulnerability in unpatched Bitcoin installations has been discovered, which can lead to a permanent wedge at the current highest block. Attackers can achieve this by duplicating one of the transactions while preserving the Merkle root. The attacker does not need to mine their own block but instead can mutate a block and pass it on to their peers after listening for one. This vulnerability also allows an attacker to hijack large miners and exchanges, resulting in double-spend attacks until miners notice they have been forked and fixed their bitcoind. The flaw is due to the Merkle hash implementation used by Bitcoin to calculate the Merkle root in a block header. An attacker can easily construct multiple lists of hashes that map to the same Merkle root, allowing two blocks to be created that have the same block hash but one can be valid and the other invalid. The attack can be executed on an unpatched Bitcoin installation, which can be permanently wedged at its current highest block due to Bitcoin caching orphan blocks in a disk-backed database.To mitigate the risk, Eloipool has attempted to produce blocks with only transaction counts that are powers of two because such blocks cannot be used for an attack against vulnerable clients. After responsible disclosure of the vulnerability, a request has been made to update the code with more information. The commit made by Gavin only mentions a DoS attack without going into further detail about it. Therefore, the vulnerability of the Merkle hash function should also be noted within the code.Gavin Andresen has fixed the issue and rejected blocks with duplicate transactions in CheckBlock, preventing them from being cached at all. An attacker could target specific blocks they want orphans by performing this attack on a majority of miners with the “tip” block they want orphaned. It is important to patch the code to prevent any potential attacks.</p>
        <hr>
        <p><i>Updated on: 2023-06-06T07:07:54.384296+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>