<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>BIP174 extension proposal (Global Type: PSBT_GLOBAL_XPUB_SIGNATURE)</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Jonathan Underwood 2019-06-27 05:07:47
            <br><i>Published on: 2019-06-27T05:07:47+00:00</i></p>

        
        

        
        
        <li>
        <a href="/bitcoin-dev/June_2019/combined_BIP174-extension-proposal-Global-Type-PSBT-GLOBAL-XPUB-SIGNATURE-.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-June/017048.html">Click here to read original discussion on the bitcoin-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The email exchange discusses a proposed extension of PSBT to solve the problem of verifying whether the address being sent to is not a hacker's address that was swapped in between unsigned tx creation and first signature. The proposal involves signing xpubs with cold keys, such that the cold keys can check destination addresses are trusted. However, Dmitry Petukhov raises concerns about how the scheme handles multisig wallets. He suggests signing the whole 'xpub package' of the multisig wallet, but there is also an issue of 'partial compromise', where some of the keys in a multisig warm wallet are compromised. His idea is to use an auxiliary message that would be signed along with the 'xpub package', and that message can include specific 'epoch' word that hardware wallet can show prominently before signing, or have 'serial number' for xpub packages. Jonathan Underwood proposes a key value specification to solve the verification problem and presents a rough draft of the proposal. The proposed solution involves securely verifying the xpub of the warm/hot wallet, signing the xpub with all cold keys using the airgap signing tool, uploading the signature/xpub pairs to the online unsigned transaction generator, including one keyval pair per coldkey/xpub pairing, and verifying that all outputs have BIP32_DERIVATION and that it can verify the outputs through the derivation, to the xpub, and to the signature while offline signing. Jonathan acknowledges the concern over the huge number of possible schemes that each may probably require its own PSBT field type, and suggests dealing with it outside of PSBT as 'PSBT metainformation', or using some form of 'vendor-specific', or 'metainformation-specific' PSBT field.</p>
    <hr>
    <p><i> Updated on: 2023-06-13T19:33:05.018899+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>