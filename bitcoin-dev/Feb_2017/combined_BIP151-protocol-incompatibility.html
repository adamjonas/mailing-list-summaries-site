<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>BIP151 protocol incompatibility <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013568_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-13 10:07:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013583_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-14 19:54:37</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013584_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-14 20:58:54</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013565_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 05:18:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013568_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-13 10:07:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013569_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 10:16:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013570_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 11:11:11</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013574_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 11:17:11</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013565_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 05:18:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013567_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 09:36:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013570_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 11:11:11</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013574_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 11:17:11</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013566_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Pieter Wuille 2017-02-13 08:47:38</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013567_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 09:36:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013577_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 13:04:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013566_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Pieter Wuille 2017-02-13 08:47:38</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013569_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 10:16:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013570_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 11:11:11</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013571_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-13 11:14:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013566_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Pieter Wuille 2017-02-13 08:47:38</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013569_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 10:16:13</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013572_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 10:30:14</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013573_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 10:54:23</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013584_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-14 20:58:54</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013565_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 05:18:41</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013567_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 09:36:21</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013572_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 10:30:14</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013573_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 10:54:23</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013574_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 11:17:11</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013577_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 13:04:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013571_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-13 11:14:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013572_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 10:30:14</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013573_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-13 10:54:23</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013583_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-14 19:54:37</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013584_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-14 20:58:54</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013568_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-13 10:07:12</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013571_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Jonas Schnelli 2017-02-13 11:14:01</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013577_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Matt Corallo 2017-02-13 13:04:15</b>
                    </li>
                
                    <li>
                        <a href="/bitcoin-dev/Feb_2017/013583_BIP151-protocol-incompatibility.html">BIP151 protocol incompatibility</a>
                        <b>Eric Voskuil 2017-02-14 19:54:37</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-February/013568.html">Click here to read the original discussion on the bitcoin-dev mailing list</a>
        
        <p><i>Published on: 2017-02-13T10:07:12+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>A recent Bitcoin development discussion centered on the implementation of BIP151, which encrypts messages between nodes. However, concerns were raised about its backward compatibility as it violated previous patterns of behavior by allowing the new control message to be sent before the version handshake. The protocol specification does not indicate that communication must be terminated when messages are transmitted before the version handshake has been completed, but this can lead to potential DOS attacks and incompatibilities if unknown message types are not handled correctly.The participants suggested alternative approaches to determining optional features within the protocol and emphasized the importance of soliciting community feedback before implementing changes that could break fundamental aspects of the P2P protocol handshake. The current flexibility exists because we do not drop unknown messages, but this could be up to the implementation. Once BIP151 is widely deployed, it may make sense to bump the protocol version, but this needs to be done after implementation and deployment. A protocol minversion for BIP151 should be set once it has been widely deployed.In terms of denial-of-service (DOS) attacks, waste of bandwidth is a significant concern. If a peer floods a node with addr messages, the node can manage it because it understands the semantics of these messages. However, if a node is required to allow any message that it cannot understand, it has no recourse to determine whether it is under attack or if the behavior is correct for proper operation. It is important to consider how unknown message types are handled in general, as any peer can send any type of message at any time, regardless of whether it is specified in a BIP.The discussion also touched on the compatibility of feefilter BIP 133 and sendheaders BIP130 with BIP151, which violated the rule of enabling messages by protocol version. New messages can only be added after the handshake negotiates the higher version; otherwise, the handshake is both irrelevant and broken for all existing protocol versions. It was noted that not all BIPs follow the same pattern, and it is not helpful to imply that they do.Despite concerns about backward compatibility and potential DOS attacks, allowing unknown-messages before the version handshake makes the protocol flexible and has allowed for the deployment of new features like compact blocks and fee filter without breaking backward compatibility. However, there is a debate about how to handle unknown messages and whether banning peers who send them is necessary. Eric Voskuil argues that allowing unknown messages encourages protocol incompatibility, while Matt Corallo explains that otherwise-ignored messages are exchanged to set up optional features, and old nodes can still communicate effectively. The participants emphasized the importance of maintaining existing protocol behavior and soliciting community feedback before implementing changes that could break fundamental aspects of the P2P protocol handshake. The proposed changes to the protocol negotiation process suggested using otherwise-ignored messages to set up optional features in the version handshake. However, this approach was argued to be not backward compatible and could open up new attack vectors.</p>
        <hr>
        <p><i>Updated on: 2023-06-11T21:34:05.162780+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>