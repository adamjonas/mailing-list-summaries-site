<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Return to the Layered Commit Transactions? <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000350_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Anthony Towns 2015-11-27 05:14:46</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000364_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Anthony Towns 2015-11-30 01:25:54</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000339_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Mats Jerratsch 2015-11-24 17:47:36</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000343_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Anthony Towns 2015-11-25 09:07:54</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000361_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Anthony Towns 2015-11-27 21:27:42</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000341_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Rusty Russell 2015-11-25 00:02:54</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2015/000346_Return-to-the-Layered-Commit-Transactions-.xml.html">Return to the Layered Commit Transactions?</a>
                        <b>Rusty Russell 2015-11-27 03:42:55</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-November/000350.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2015-11-27T05:14:46+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The discussion between Rusty Russell and Anthony Towns centers around the constraints for HTLCs and commitment transactions in the context of Bitcoin. They explain that the revocation time must be long enough to spot cheating, and the HTLC inter-hop-delta should be much greater than the revocation time. The proposed protocol ensures that S >= P+d and S >= X when A is paying the HTLC and wants to claim a refund by unilaterally closing the channel. The conversation also highlights the need for channels to have parameters "t" and "k" as well as "d" to drop to the blockchain well before T actually comes around.Anthony suggests adding further constraints on timeouts based on fees to avoid being left holding the bag and recommends expiring 1000 concurrent HTLCs on a channel in five batches of 20 instead of individually for better efficiency. However, while experimenting with timeouts for CSV and CLTV, Mats Jerratsch discovered issues related to the design of single output of scripts and commit transaction, where HTLCs cannot have a long revocation time and a short refund time simultaneously. This results in problematic race conditions where both parties can technically claim the payment depending on the propagation time of the transaction. To solve this issue, he proposes separating 'claiming-a-payment-using-R' and 'revoking-an-output' into two layers, enforced by revealing R within a separate timeframe than the revocation timeframe.The conversation also discusses the calculations necessary to determine the timeout on outgoing HTLC, which is determined by factors such as T, d, n, and f. If the HTLC has not been resolved off-chain at time T-d-f, one needs to publish the commitment transaction and spend it immediately. At time T+f+n, one will be confident that the transaction is safe. Anthony proposes requiring proof that a commit tx was published or closing the channel oneself to create such proof if there is no fast resolution on an HTLC. The issue, however, is that the number of hops ahead is unknown, and setting a fixed timeout for all nodes would result in all nodes closing the channel at once.</p>
        <hr>
        <p><i>Updated on: 2023-06-03T15:54:06.188306+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>