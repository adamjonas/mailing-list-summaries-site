<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Return to the Layered Commit Transactions?</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Anthony Towns 2015-11-27 21:27:42
            <br><i>Published on: 2015-11-27T21:27:42+00:00</i></p>

        
        

        <li>
        <a href="/lightning-dev/Nov_2015/combined_Return-to-the-Layered-Commit-Transactions-.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-November/000361.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The email conversation between Anthony Towns and Rusty Russell discusses the calculations necessary to determine the timeout on outgoing HTLC. The timeout is determined by several factors such as T, the timeout in the HTLC; d, the CSV delay in the HTLC; n, how long it takes to be confident someone else can't double spend an input to the transaction and f, how long it takes for transactions to get the first confirmation given how much fee is paid.If the HTLC has not been resolved off-chain at time T-d-f, one needs to publish the commitment transaction, which will hit the chain at time T-d. At time T, both the CTLV and CSV clauses are satisfied so one can spend it. One should attempt to do so immediately. The tx will be confirmed at time T+f. At time T+f+n, one will be confident that the tx is safe. Bob wants to work out the timeout to set on the outgoing HTLC, assuming he knows Alice's f, call it f_a; Bob knows the CSV delay on his channel with Alice, call it d_a; Bob knows the CSV delay on his channel with Carol, call it d_c; Bob knows his own f and n; Bob knows the timeout on the incoming HTLC, T_a. In order to keep the channel with Alice open, he needs to resolve the outgoing HTLC by time T_a-d_a-f_a. The time he's sure his outgoing HTLC is done is T_b+f+n. So, T_b+f+n is now or there is no point forwarding the HTLC since he'd have to close the channel immediately and it is now + d + f.</p>
    <hr>
    <p><i> Updated on: 2023-05-18T15:58:21.436202+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>