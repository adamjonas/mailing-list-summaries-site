<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal to include some form of best effort routing, fragmentation and local AMP <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/Nov_2018/001626_Proposal-to-include-some-form-of-best-effort-routing-fragmentation-and-local-AMP.xml.html">Proposal to include some form of best effort routing, fragmentation and local AMP</a>
                        <b>René Pickhardt 2018-11-16 10:27:41</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Nov_2018/001630_Proposal-to-include-some-form-of-best-effort-routing-fragmentation-and-local-AMP.xml.html">Proposal to include some form of best effort routing, fragmentation and local AMP</a>
                        <b>ZmnSCPxj 2018-11-17 03:21:40</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-November/001626.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2018-11-16T10:27:41+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>René Pickhardt, in a Lightning-dev email thread, proposed implementing a second routing algorithm to improve payment reliability and mitigate slow payments or failures. The suggested solution involves local payment fragmentation, also known as local AMP, which would allow intermediate nodes to fragment an HTLC and find alternative paths to forward a payment. One way to do this would be by using friend-of-a-friend information to determine if the original HTLC can be forwarded from Alice to Bob in a fragmented way. The autopilot feature could benefit this approach by creating many triangles in the network for friend-of-a-friend nodes to exist. The sender can still choose the basic route, and the full route remains private.Another solution proposed was for two nodes that fail to forward the HTLCs to work collaboratively to find a path between them and return this information as a routing suggestion to the payer. To further improve payment reliability, ZmnSCPxj suggested using active probing and ping before commitment. Ping before commit reduces the window for stuck payments by pinging the next node before offering an HTLC, allowing us to figure out if the connection dropped before sending the HTLC.The issue of slow and failing payments on the lightning network was recently discussed in Adelaide. While design changes after BOLT1.1 may help mitigate this problem, Rene Pickhardt proposed an additional solution to improve path finding. This proposal involves implementing a second routing algorithm based on best effort routing/forwarding with the help of local payment fragmentation (or local AMP). The idea is to allow intermediate nodes to fragment a payment to reach the next hop specified in the onion without compromising privacy. For instance, if Alice needs to forward a payment to Bob but doesn't have enough funds on her side, she could try to fragment the payment and find several paths (or maybe just one path) to Bob. While the original payer can still select the basic route and the full route remains private, the sender could choose paths with common friends for each pair of nodes on the path to increase the probability of successful local fragmentation. However, the original payer would have to allow a package to be locally fragmented by including more fees at each hop and increasing the CLTV deltas in each hop so that an additional hop can be included and financed. In case local AMP is too complex and expensive, two nodes that fail to forward HTLCs could work collaboratively to find a path between them and return this information as a routing suggestion in the error message, so that the adapted onion package could be tried and sent by the payer.</p>
        <hr>
        <p><i>Updated on: 2023-06-02T04:36:53.696998+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>