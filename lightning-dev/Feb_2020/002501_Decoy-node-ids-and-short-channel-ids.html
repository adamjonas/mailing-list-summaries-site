<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Decoy node_ids and short_channel_ids</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Rusty Russell 2020-02-05 01:28:43
            <br><i>Published on: 2020-02-05T01:28:43+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/Feb_2020/combined_Decoy-node-ids-and-short-channel-ids.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-February/002501.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Bastien Teinturier has expressed his concerns regarding invoice fraud in Lightning Network. He explains that if Mallory gets two invoices, she can use the wrong Payment Identifier(P_I) from one of the invoices for Bob to forward an HTLC with a different route hint. Bastien believes that this attack is interesting and since payment_secret and decoy_key are both used to derive the decoy_scid, his proposal defends against this attack. However, he concedes that he may be missing something and urges others to verify his proposal.Mallory can use this same attack even if Bastien's proposal is implemented. She can include the P_I from the wrong invoice for Bob to forward an HTLC. According to Bastien, this cannot be defended against by the current RFC pull request. Bob will forward an HTLC that uses N1 with C2 if both invoices are valid because Bob has no way of knowing which node ID(N1 or N2) was used in the onion. To avoid this, Alice needs to share her decoy_node_ids with Bob (and the mapping to a decoy_scid). Rusty suggests that Bob can include the scid he used in the update_add_htlc message so that Alice can check. Rusty expresses concern about custodial lightning services restricting what they will pay to due to immense KYC pressure. He prefers a system that doesn't add any requirements on the payer.</p>
    <hr>
    <p><i> Updated on: 2023-06-02T22:46:35.905479+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>