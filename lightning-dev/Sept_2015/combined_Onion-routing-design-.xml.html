<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Onion routing design. <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
    <ul>
        
        
        <li>
        <a href="/lightning-dev/Sept_2015/000205_Onion-routing-design-.xml.html">Onion routing design.</a>
        <b>Anthony Towns 2015-09-22 05:25:44</b>
        </li>
        
        <li>
        <a href="/lightning-dev/Sept_2015/000204_Onion-routing-design-.xml.html">Onion routing design.</a>
        <b>Anthony Towns 2015-09-22 01:22:57</b>
        </li>
        
        <li>
        <a href="/lightning-dev/Sept_2015/000194_Onion-routing-design-.xml.html">Onion routing design.</a>
        <b>Anthony Towns 2015-09-19 01:44:18</b>
        </li>
        
        <li>
        <a href="/lightning-dev/Sept_2015/000193_Onion-routing-design-.xml.html">Onion routing design.</a>
        <b>Anthony Towns 2015-09-19 01:27:16</b>
        </li>
        

        
    </ul>
    
        <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-September/000205.html">Click here to read original discussion on the lightning-dev mailing list</a>
    
    <p><i>Published on: 2015-09-22T05:25:44+00:00</i></p>
    <hr>
    <h3> Summary:</h3>
    <p>The discussion revolves around the weakness of the Lightning Network routings with no MAC. Despite having R values, a nosy node can replace the routing entirely if it guesses the final destination correctly to probe. One defense is to fail to allow two HTLCs with the same R value, but this allows a simple way to probe back to the source. Probabilistic backoff of duplicate R values might be an option; however, a sophisticated probe sequence could still get probability. The idea of parallel probes doesn't work well since your neighbor knows R and can claim all of your probes. A solution proposed was to have two R values - one known only by the recipient, and one by the sender (S) to make the HTLCs payable on presentation of both R and S. The onion payload includes S encrypted to the final recipient where munging the payload makes the HTLC irredeemable, so misrouting gives no information. Nodes create the route backward to calculate the size, pick a total size randomly between 1024 and 4096, and pad it to that size with random padding of at least 32 bytes. The onion blob should be re-padded when forwarded to avoid dropping below 1024 bytes, which would enable the determination of being near the end of the chain. Adding random bytes to it or appending the encrypted bytes that made up the post of the payload from incoming messages should work. If OFB or CTR mode is used for the symmetric cipher, D_KD() of all the padding can be calculated to work out the hash H of the plain text message. CBC mode cannot be used because E_KD(grbg) needs to be known to know D_KD(padding).</p>
    <hr>
    <p><i> Updated on: 2023-05-18T01:50:34.593530+00:00 </i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>