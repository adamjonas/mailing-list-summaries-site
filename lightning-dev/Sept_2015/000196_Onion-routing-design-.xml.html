<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Onion routing design.</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Rusty Russell 2015-09-20 20:48:37
            <br><i>Published on: 2015-09-20T20:48:37+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/Sept_2015/combined_Onion-routing-design-.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-September/000196.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a thread on the Lightning Network mailing list, Rusty Russell discussed a weakness in the network's security regarding route probing attacks. The problem is that there is no MAC to protect against nosy nodes replacing the routing past the next hop. This means that someone could replace it entirely and probe by guessing the final destination right. Russell says he can't see a general fix for this. Channel capacity might not be an issue for tiny micropayments, but the reveal of R is a good point; such probing should have a real cost on success. Russell believes that parallel probes don't work well because if any of your probes succeed, your neighbor knows R and can claim all of your probes. Parallelization is also limited by channel capacity unless the payee knows how much to expect. If someone wants to know whether you're sending money to someone else, they could get a cheap hub near both parties and probe every payment which passes through both. However, Russell thinks that this type of surveillance is fairly boutique and doesn't scale. For a general solution to rule out probing, Russell suggests having two R values, one known only by the recipient and one by the sender, making the HTLCs payable on presentation of both R and S and including S encrypted to the final recipient in the onion payload. Munging the payload then makes the HTLC irredeemable so misrouting it gives no information. He thinks it is clever and would require more coffee to determine if the transaction structure needs revision to include this.</p>
    <hr>
    <p><i> Updated on: 2023-05-23T20:12:12.404461+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>