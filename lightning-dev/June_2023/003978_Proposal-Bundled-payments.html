<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Olaoluwa Osuntokun 2023-06-14 02:56:54+00:00
            <br><i>Published on: 2023-06-14T02:56:54+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003978.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a proposal by Thomas Voegtlin, an extension to BOLT-11 is suggested to include two bundled payments in an invoice. This feature would be beneficial for services like submarine swaps and JIT channels that require prepayment of mining fees. Currently, some dedicated client software can handle the prepayment, but other services, such as Boltz exchange, cannot. These services show an invoice to users, whose wallets are agnostic about the swap, and it would be impractical to display two invoices simultaneously. This vulnerability exposes these services to denial-of-service (DoS) attacks where attackers force them to pay on-chain fees.Similarly, in the case of JIT channels, providers need to ask for the preimage of the main payment before opening the channel to protect against mining fee attacks. However, this makes the service custodian, which poses legal issues. The proposed solution is to bundle the prepayment and the main payment in the same BOLT-11 invoice. The semantics of bundled payments would involve waiting for all HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment would fail with a MPP timeout. Once all HTLCs have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts the on-chain transaction.Voegtlin acknowledges that this proposal does not prevent service providers from stealing the prepayment, but this risk already exists. Implementing this change in BOLT-11 would level the playing field among lightning service providers, allowing non-custodian options to compete without exposing themselves to mining fee attacks. Additionally, ACINQ would benefit from this proposal as it would enable them to make their pay-to-open service fully non-custodian, avoiding potential regulatory issues. Voegtlin believes that this change should be made in BOLT-11 rather than using BOLT-12 or onion messages, as it can be achieved in a non-interactive way without the need for new message exchanges.</p>
    <hr>
    <p><i> Updated on: 2023-07-04T03:00:03.404771+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>