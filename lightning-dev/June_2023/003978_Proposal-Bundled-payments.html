<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Olaoluwa Osuntokun 2023-06-14 02:56:54+00:00
            <br><i>Published on: 2023-06-14T02:56:54+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003978.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a proposal to extend BOLT-11, Thomas Voegtlin suggests the inclusion of two bundled payments with distinct preimages and amounts in an invoice. This proposal is aimed at addressing the need for prepayment of mining fees in services like submarine swaps and JIT channels. Currently, services utilizing dedicated client software can ask for prepayment, but those that rely on wallet agnostic about the swap, such as the Boltz exchange, face difficulties in showing two invoices simultaneously. This vulnerability exposes them to DoS attacks where attackers force them to pay on-chain fees.Similarly, in the case of JIT channels, providers who want to protect themselves against mining fee attacks have to ask for the preimage of the main payment before opening the channel. However, this makes their service custodian, falling within the scope of European MICA regulation. Competitors like Electrum, who refuse to offer custodian services, are excluded from this game.To solve these issues, bundling the prepayment and main payment in the same BOLT-11 invoice would be beneficial. The proposed semantics of bundled payments involve waiting for all HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should be failed with an MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction.Voegtlin acknowledges that this proposal does not prevent service providers from stealing the prepayment. However, he believes it would level the playing field between lightning service providers and allow ACINQ to make their pay-to-open service fully non-custodian, potentially avoiding falling under the European MICA regulation.The proposed change is suggested to be implemented in BOLT-11 rather than using BOLT-12 or onion messages, as it does not require the exchange of new messages and can be done in a non-interactive way. The goal is to simplify the process without adding unnecessary complexity.Overall, this proposal aims to address the challenges faced by service providers in requiring prepayment of mining fees and create a more competitive environment among lightning service providers.</p>
    <hr>
    <p><i> Updated on: 2023-07-03T03:07:27.955522+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>