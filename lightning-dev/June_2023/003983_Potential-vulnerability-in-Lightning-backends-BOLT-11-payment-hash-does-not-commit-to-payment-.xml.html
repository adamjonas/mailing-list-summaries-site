<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment!</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> callebtc 2023-06-19 15:26:05+00:00
            <br><i>Published on: 2023-06-19T15:26:05+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003983.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a recent discovery, the LNbits team found an exploit that allowed attackers to create fake balances by abusing a quirk in how invoices are handled. The issue has been patched in LNbits version 0.10.5, and users are urged to update their systems. The attack involved an attacker inserting a bolt-11 payment hash into a different payment to create a malicious invoice. The backend would then believe that the two payments were the same. The attacker could then create a new account and pay the malicious invoice, resulting in the creation of 999 sats. To mitigate this kind of attack, backends should use self-generated unique "checking id's" for looking up internal payments or use additional checks to make sure that the invoice details have not been tampered with. Developers should also be aware that the "payment hash" of an invoice is not a "payment" hash but merely a "preimage" hash â€“ and nothing else. This naming convention could lead developers to assume that the hash commits to payment details like amount and pubkey when it doesn't.</p>
    <hr>
    <p><i> Updated on: 2023-06-21T01:27:40.816311+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>