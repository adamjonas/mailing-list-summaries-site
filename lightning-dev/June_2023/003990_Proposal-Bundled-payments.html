<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> SomberNight 2023-06-20 16:49:05+00:00
            <br><i>Published on: 2023-06-20T16:49:05+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003990.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a recent discussion on the lightning-dev mailing list, ThomasV proposes a solution to protect lightning service providers from DoS attacks. Currently, providers like Boltz are vulnerable to these attacks where attackers force them to pay on-chain fees. To counter this, ThomasV suggests the use of Just-In-Time (JIT) channels, where the provider asks for the preimage of the main payment before opening the channel. However, this approach makes the service custodian and subject to European MICA regulation.To address this issue, ThomasV proposes the concept of bundled payments in BOLT-11 invoices. In this model, the invoice would include two preimages and two amounts: prepayment and main payment. The receiver would wait for both payments' HTLCs to arrive before fulfilling the pre-payment's HTLCs. If the main payment fails to arrive, the pre-payment would be failed with a MPP timeout. Once both payments' HTLCs are received, the receiver fulfills the prepayment's HTLCs and broadcasts their on-chain transaction. It is important to note that the main payment can still fail if the sender does not reveal the preimage.While this proposal does not prevent service providers from stealing the pre-payment, ThomasV believes it would level the competition among lightning service providers. Currently, Loop requires a dedicated client, putting competitors without an established user base at risk of mining fee attacks. Additionally, ACINQ could benefit from this proposal by making its pay-to-open service fully non-custodian, thus avoiding the European MICA regulation.ThomasV suggests implementing this change in BOLT-11 rather than introducing new messages through BOLT-12 or onion messages. He argues that adding unnecessary complexity should be avoided and that non-interactive methods can achieve the desired outcome.Overall, ThomasV's proposal aims to enhance the security and competitiveness of lightning service providers, while also addressing legal considerations. The discussion on the lightning-dev mailing list provides valuable insights and feedback on this topic.</p>
    <hr>
    <p><i> Updated on: 2023-07-02T03:12:38.724478+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>