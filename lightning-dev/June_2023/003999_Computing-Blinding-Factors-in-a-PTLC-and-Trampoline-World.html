<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Computing Blinding Factors in a PTLC and Trampoline World</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> ZmnSCPxj 2023-06-28 20:34:37+00:00
            <br><i>Published on: 2023-06-28T20:34:37+00:00</i></p>

        
        

        
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003999.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In this mathematical demonstration, the author explains a method for computing blinding factors that allows for secure communication between multiple nodes without revealing unnecessary information. The ultimate receiver has a secret value 'r' and provides the ultimate sender with the point 'R', which is equal to 'r * G'. In the simplest case where there are no intermediate nodes, the sender chooses a random scalar 'e' as the error blinding factor and constructs an onion with 'e' encrypted for the receiver. The sender also offers a PTLC (Point-Time Locked Contract) with the point 'e * G + R' for the receiver to claim by revealing 'e + r'. This ensures that only the receiver can claim the PTLC.However, when there is an intermediate node, such as Carol, involved, the sender needs to generate additional scalars 'c' and 'd' such that 'c + d = e'. The sender encrypts the onion with 'e' for the receiver and 'd' for Carol. The PTLC sent to Carol is 'c * G + R'. Carol adds 'd * G' to this point and sends a PTLC with 'c * G + R + d * G' to the next hop. In both the direct case and the indirect case, the receiver still sees 'e * G + R' and cannot differentiate between them.If Carol is a trampoline node and does not know that the ultimate receiver is the final trampoline hop, the sender encrypts 'e' for the receiver, 'd' for Carol, and the next trampoline hop to Carol. Carol then searches for a route to the ultimate receiver and creates an onion with 'b' encrypted for Alice. Alice decrypts the onion, learns 'b', and forwards the PTLC to the next hop. Again, the ultimate receiver sees 'e * G + R' and cannot distinguish whether it reached via a trampoline or directly.In all cases, each intermediate node has enough information to claim its incoming PTLC, but only the ultimate sender knows 'c' and can recover 'r'. This method allows for secure communication between nodes while preserving privacy and ensuring that unnecessary information is not revealed.</p>
    <hr>
    <p><i> Updated on: 2023-07-13T03:05:48.829300+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>