<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Steve Lee 2023-06-20 17:16:52+00:00
            <br><i>Published on: 2023-06-20T17:16:52+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003992.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a recent discussion on the Lightning-dev mailing list, Thomas Voegtlin proposed an extension to BOLT-11, the Lightning Network protocol. He suggested adding the ability for invoices to contain two bundled payments with distinct preimages and amounts. The use case for this proposal is services that require prepayment of a mining fee for non-custodian exchanges, such as submarine swaps and JIT channels.Submarine swap services like Loop by Lightning Labs can ask for a prepayment because their software can handle it. However, competitors like the Boltz exchange, which do not require a dedicated wallet, cannot easily ask for a prepayment. This leaves them vulnerable to denial-of-service (DoS) attacks where attackers force them to pay on-chain fees. JIT channel providers also face similar challenges in protecting against mining fee attacks.To avoid becoming custodians and falling within regulatory frameworks, these providers need to ask for the preimage of the main payment before opening the channel. However, this creates custodial risks and excludes competitors who refuse to offer custodian services. To address these issues, Thomas proposes bundling the prepayment and main payment in the same BOLT-11 invoice.The semantics of bundled payments would involve the receiver waiting for all HTLCs of both payments to arrive before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should be failed with a MPP timeout. Once both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts the on-chain transaction.Although this proposal does not prevent service providers from stealing the prepayment, Thomas believes it would level the competition field between lightning service providers and benefit companies like ACINQ by making their pay-to-open service fully non-custodian. Thomas acknowledges that implementing this change may take time and suggests making it optional during a transition period. He also believes that two major implementations, Lightning Labs and ACINQ, have an incentive to support this proposal. Thomas suggests that this feature could be included in BOLT-12, which Lightning Labs and ACINQ are actively working on, rather than updating BOLT-11.In the discussion, Matt Corallo responds to Thomas's proposal, expressing skepticism about getting a new interoperable change into BOLT-11 and suggesting that the need for swaps may be obviated by splice-out.In summary, Thomas Voegtlin proposes adding bundled payments to BOLT-11 invoices to address the challenges faced by services that require prepayment of mining fees. He believes this change would level the competition field between lightning service providers and benefit companies like ACINQ.In a recent discussion on the Lightning-dev mailing list, ThomasV proposed a solution for a use case that does not require the exchange of new messages. The proposal suggests using BOLT-11 instead of BOLT-12 or onion messages, as adding new messages would unnecessarily complicate the process.ThomasV received initial feedback suggesting the use of BOLT-12 or OM, but he believes that non-interactive methods should be prioritized. The discussion took place on the Lightning-dev mailing list, which is hosted by the Linux Foundation.Electrum Technologies GmbH, based in Berlin, Germany, is mentioned in the context as well. It is highlighted that Thomas Voegtlin is the Geschäftsführer (Managing Director) of the company.Overall, ThomasV's proposal aims to simplify the process by avoiding the need for additional message exchanges and opting for a non-interactive approach using BOLT-11.</p>
    <hr>
    <p><i> Updated on: 2023-07-03T03:09:26.298473+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>