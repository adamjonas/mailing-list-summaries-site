<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Thomas Voegtlin 2023-06-13 08:10:29+00:00
            <br><i>Published on: 2023-06-13T08:10:29+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003977.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>ThomasV has proposed an extension to BOLT-11, where an invoice can contain two bundled payments with distinct preimages and amounts. This proposal is aimed at services that require the prepayment of a mining fee for a non-custodian exchange to take place, such as submarine swaps and JIT channels. The service provider receives a HTLC for which they do not have the preimage, have to send funds on-chain to the channel or submarine swap funding address, and wait for the client to reveal the preimage when they claim the payment. Currently, competitors who do not require a dedicated wallet cannot ask for prepayment, and this creates a situation where they are vulnerable to DoS attacks. Providers who want to protect themselves against this mining fee attack need to ask for the preimage of the main payment before opening the channel, which makes their service custodian. In order to solve this, ThomasV believes it would be beneficial to bundle the prepayment and the main payment in the same BOLT-11 invoice.The semantics of bundled payments involve the BOLT-11 invoice containing two preimages and two amounts: prepayment and main payment, and the receiver should wait until all the HTLCs of both payments have arrived before they fulfill the HTLCs of the pre-payment. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment, and they broadcast their on-chain transaction. ThomasV believes this proposal would level the field in terms of competition between lightning service providers. Currently, you need to use a dedicated client to use Loop, and competitors who do not have an established user base running a dedicated client are exposed to the mining fee attack. He also believes that ACINQ would benefit from this because it would make it possible for them to make their pay-to-open service fully non-custodian. Finally, ThomasV believes that such a change should be implemented in BOLT-11 and not using BOLT-12 or onion messages as his proposal does not require the exchange of new messages.</p>
    <hr>
    <p><i> Updated on: 2023-06-23T01:41:38.777506+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>