<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Thomas Voegtlin 2023-06-14 08:09:45+00:00
            <br><i>Published on: 2023-06-14T08:09:45+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003979.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The context discusses the possibility of distributing a submarine swap client that is separate from the lightning wallet of the user, which could enable competition in the space. Boltz, for example, is distributing a Progressive Web App that serves javascript and allows for proper checks and sweep of funds. However, it is unclear whether their app is doing this correctly. Lightning Loop could benefit from this separation by distributing an app that does not require a local LND instance, thereby increasing its potential user base. The missing ingredient for this setup is the bundling of fee prepayment and main payment in the same invoice.There is an ongoing standardization effort for LSP (Lightning Service Provider) protocols, and Boltz is currently working to add submarine swaps to it. In order to be properly non-custodial, a submarine swap client needs to be able to unilaterally sweep or timeout an on-chain HTLC and validate all the swap parameters. While Boltz's website shows an invoice to the user, the user's wallet may be agnostic about the swap, making it impractical to show two invoices simultaneously. This vulnerability creates a situation where Boltz is susceptible to denial-of-service (DoS) attacks, forcing them to pay on-chain fees.The proposal suggests extending BOLT-11, the Lightning Network invoice protocol, to include two bundled payments with distinct preimages and amounts. This would address the need for prepayment of a mining fee in services like submarine swaps and JIT (Just-In-Time) channels. Currently, services that use dedicated client software can ask for a prepayment, but competitors who require a dedicated wallet, like Boltz, cannot. Bundling the prepayment and main payment in the same invoice would ensure that both payments arrive before fulfilling the pre-payment HTLCs.The proposal aims to level the playing field for lightning service providers and enable non-custodian services. It would also benefit ACINQ by making their pay-to-open service fully non-custodian, potentially avoiding regulatory issues. The suggested change should be implemented in BOLT-11 rather than using new messages or protocols like BOLT-12 or onion messages. The goal is to keep things non-interactive and avoid unnecessary complexity.Overall, the context highlights the potential for separate submarine swap clients and the need for bundling prepayment and main payment in the same invoice to enable competition and non-custodial services in the lightning network ecosystem.</p>
    <hr>
    <p><i> Updated on: 2023-07-04T02:59:50.047177+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>