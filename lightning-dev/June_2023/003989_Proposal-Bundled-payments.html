<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Bastien TEINTURIER 2023-06-20 16:44:17+00:00
            <br><i>Published on: 2023-06-20T16:44:17+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003989.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a conversation between Thomas and Bastien, they discuss the possibility of combining pre-payment of the mining fee with 0-conf. Bastien points out that he doesn't see 0-conf going away even with BOLT-12. Thomas asks if bundled payments would work with the current specification or require changes to BOLT-12. Bastien explains that it would require adding a TLV field to Bolt 12 invoices or onion messages, and suggests that a prepayment solution based on Bolt 12 could provide a more satisfying protocol.Bastien expresses his belief that it will take years for BOLT-12 to become the dominant payment method on Lightning after it is merged. However, he thinks that if this feature was adopted in BOLT-11, it could be deployed much faster. Thomas questions why Bastien believes it would be faster using Bolt 11, as it still requires software updates and implementers are currently focused on Bolt 12. Bastien clarifies that his proposal aims to level the field of competition between Lightning service providers.In another conversation between Thomas and David, they discuss the semantics of bundled payments. Thomas explains that the BOLT-11 invoice should contain two preimages and two amounts: prepayment and main payment. The receiver should wait until all the HTLCs of both payments have arrived before fulfilling the HTLCs of the prepayment. If the main payment does not arrive, the prepayment should be failed with an MPP timeout. Once the HTLCs of both payments have arrived, the receiver fulfills the HTLCs of the prepayment and broadcasts their on-chain transaction.David suggests the possibility of using a keysend payment for the prepayment instead of including it in the BOLT11 invoice. He proposes extending BOLT11 invoices with an extra_fee_via_keysend field, which would be smaller and could be encoded in an existing BOLT11 field like description or metadata. This would allow for immediate implementation until an updated version of BOLT11 or an alternative using offers becomes widely deployed.Overall, the discussions revolve around the combination of pre-payment and 0-conf, the use of bundled payments with BOLT-12, the potential adoption of these features in BOLT-11, and the desire for a more satisfying solution to level the competition among Lightning service providers.</p>
    <hr>
    <p><i> Updated on: 2023-07-13T02:58:10.345624+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>