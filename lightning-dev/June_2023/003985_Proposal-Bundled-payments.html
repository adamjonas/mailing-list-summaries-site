<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> David A. Harding 2023-06-19 20:29:34+00:00
            <br><i>Published on: 2023-06-19T20:29:34+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003985.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In an email conversation between Thomas Voegtlin and Dave, the semantics of bundled payments are discussed. Voegtlin explains that a BOLT-11 invoice, which is used in the Lightning Network protocol, contains two preimages and two amounts: a prepayment and a main payment. He further explains that the receiver should wait until all the Hashed Time-Locked Contracts (HTLCs) of both payments have arrived before fulfilling the HTLCs of the pre-payment. If the main payment does not arrive, the pre-payment should be failed with a MPP (Multi-Path Payments) timeout. Once the HTLCs of both payments have arrived, the receiver can fulfill the HTLCs of the prepayment and broadcast their on-chain transaction.Dave then raises a question about whether it is necessary for a BOLT11 invoice to contain a payment hash for the prepayment or if it would be acceptable for the prepayment to use a keysend payment with an onion message payload indicating the payment hash to associate with the prepayment. He suggests extending the BOLT11 invoices with an extra_fee_via_keysend field, which would be smaller and could be encoded in existing BOLT11 fields like the description or metadata field. This would allow for immediate implementation until an updated version of BOLT11 or an alternative using offers becomes widely deployed.The discussion revolves around the technical aspects of bundled payments and the potential modifications to the BOLT11 invoice format to accommodate them. It explores the possibility of using keysend payments and additional fields in the invoice to streamline the process.</p>
    <hr>
    <p><i> Updated on: 2023-07-13T02:57:47.504720+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>