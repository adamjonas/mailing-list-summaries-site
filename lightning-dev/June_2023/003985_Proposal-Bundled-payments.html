<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> David A. Harding 2023-06-19 20:29:34+00:00
            <br><i>Published on: 2023-06-19T20:29:34+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003985.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In an email exchange between Thomas Voegtlin and Dave, they discuss the semantics of bundled payments. The BOLT-11 invoice is mentioned as containing two preimages and two amounts: a prepayment and a main payment. The receiver is advised to wait until all the HTLCs (Hashed Time-Locked Contracts) of both payments have arrived before fulfilling the HTLCs of the pre-payment. If the main payment does not arrive, the pre-payment should be failed with an MPP (Multi-Path Payments) timeout. Once the HTLCs of both payments have arrived, the receiver can fulfill the HTLCs of the prepayment and broadcast their on-chain transaction. It is noted that the main payment can still fail if the sender never reveals the preimage of the main payment.Dave raises a question regarding the requirement for a BOLT11 invoice to contain a payment hash for the prepayment. He suggests the use of a keysend payment with an onion message payload to indicate what payment hash to associate with the prepayment. This approach would involve sending the prepayment via keysend with metadata indicating that the receiver should not claim it until they receive the 1 BTC HTLC (Hashed Time-Locked Contract) associated with a specific payment hash. This alternative method would require the extension of BOLT11 invoices with an extra_fee_via_keysend field. Dave highlights that this approach would be smaller in size and could potentially be implemented immediately using existing BOLT11 fields like the description or metadata field. This implementation could serve as an interim solution until an updated version of BOLT11 or an alternative using offers becomes widely deployed.Overall, the email exchange discusses the semantics of bundled payments and explores an alternative approach involving keysend payments and the extension of BOLT11 invoices.</p>
    <hr>
    <p><i> Updated on: 2023-07-04T03:00:16.024280+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>