<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Liquidity griefing for 0-conf dual-funded txs</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Bastien TEINTURIER 2023-06-07 09:46:36+00:00
            <br><i>Published on: 2023-06-07T09:46:36+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Liquidity-griefing-for-0-conf-dual-funded-txs.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003975.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a discussion between Bastien and Antoine, they agree that the usual mempool pinning issues still apply regardless of whether 0-conf is used or not. They believe that a reasonable mid-term solution is to use v3 transactions for channel funding and splicing, with the caveat that it makes them identifiable on-chain. They also discuss the need for some kind of anti-DoS token in the longer term, but acknowledge that designing and analyzing such a solution is challenging.Antoine raises concerns about liquidity griefing in the context of dual-funding or splicing. He explains that while the "soft lock" strategy can help in non 0-conf funding attempts, it does not address all vectors of griefing. Specifically, he mentions the lack of signature release for a shared input by the counterparty as a potential issue. He also highlights the advantage of pinning the transaction in the mempool using abuse of replacement rule 3. Antoine suggests that enforcing encumbrance on contributed outputs with a 1 CSV can mitigate liquidity griefing related to mempool vectors, but acknowledges its limitations.Regarding 0-conf funding attempts, Antoine argues that it can still be valuable to disable inbound payments or require a longer cltv_expiry_delta in case of mempool fee spikes delaying chain confirmation. He notes that liquidity griefing caused by a lack of signature release or mempool funny games will always be present, even with package relay/nVersion deployment. Antoine suggests reusing solutions developed to mitigate channel jamming as a long-term solution to prevent liquidity griefing, proposing the deployment of the Staking Credentials framework by dual-funding market-makers. He explains how this framework can introduce a fee scale based on the amount of UTXOs contributed and provide privacy-preserving credentials to unlink initiators.Bastien starts the conversation by discussing the challenge of protecting against liquidity griefing attacks from malicious peers in dual funded transactions. He explains that locking utxos used in dual-funded transactions can result in locked and unusable liquidity if the remote node goes silent. Bastien suggests a solution where utxos are never locked to automatically reuse them in another instance of the protocol if the peer goes silent. However, he acknowledges that this solution falls short when using 0-conf due to the risk of accidentally double-spending a 0-conf channel. He proposes the use of a "soft lock" when selecting utxos for non 0-conf funding attempts to address this issue.Bastien further explains that nodes offering 0-conf channels must ensure isolation between utxos used for 0-conf and non 0-conf to avoid accidental double-spending. He describes a race scenario where an unlocked utxo selected for a non 0-conf funding attempt is also selected for a 0-conf funding attempt and locked, leading to accidental double-spending. To fix this, he suggests that non 0-conf funding attempts should reuse soft locked utxos.Bastien mentions that in Eclair, they currently implement opportunistic 0-conf, where they use it if they receive `channel_ready` immediately, are the only contributor to the funding transaction, and the transaction hasn't been RBF-ed yet. However, mixing 0-conf and non 0-conf funding attempts complicates this approach due to the soft locking of utxos. He concludes by seeking ideas on how to improve protections against liquidity griefing for nodes offering 0-conf services, acknowledging that while 0-conf is a pain point, users like it.</p>
    <hr>
    <p><i> Updated on: 2023-06-28T03:12:32.852447+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>