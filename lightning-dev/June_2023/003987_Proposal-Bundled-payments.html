<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Proposal: Bundled payments</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Thomas Voegtlin 2023-06-20 07:32:15+00:00
            <br><i>Published on: 2023-06-20T07:32:15+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2023/combined_Proposal-Bundled-payments.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003987.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>Hello Dave,Thank you for your interesting idea about saving space for the prepayment hash. However, in order to make the feature optional, we would need to subtract the prepayment amount from the main payment amount. For example, if Alice expects to receive 1 BTC, she would either receive (1 BTC, invoice payment_hash) or (1 BTC - minus 10k sats, invoice payment_hash) + (10k sats, prepayment_hash via keysend). This way, the receiver can decide whether prepayment is optional or required.Regarding your question, it would be acceptable for the prepayment to use a keysend payment with the onion message payload indicating what payment hash to associate with the prepayment. For example, Alice wants to receive 1 BTC to hash 0123...cdef with a prepayment of 10k sats, so the 10k sats is sent via keysend with metadata indicating that the receiver shouldn't claim it until they receive the 1 BTC HTLC to 0123...cdef.If this approach is implemented, we would only need to extend BOLT11 invoices with an extra_fee_via_keysend field. This would significantly reduce the size and allow encoding the extra_fee_via_keysend field in an existing BOLT11 field like (d) description or the relatively new (m) metadata field.</p>
    <hr>
    <p><i> Updated on: 2023-07-10T02:56:14.663869+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>