<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment! <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/June_2023/003983_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml.html">Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment!</a>
                        <b>callebtc 2023-06-19 15:26:05+00:00</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/June_2023/003986_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml.html">Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment!</a>
                        <b>Antoine Riard 2023-06-19 20:34:10+00:00</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003983.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2023-06-19T15:26:05+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>LNbits team discovered an exploit that allows attackers to create balances out of thin air by abusing a quirk in how invoices are handled internally. The attacker was able to insert a bolt-11 payment hash of payment A into a different payment, creating malicious invoice B that can trick the backend into believing that B == A. The critical part of this attack is that payment hashes do not commit to any payment details like amount but only to the preimage. Backends can mitigate this issue by using unique checking ids for looking up internal payments or additional checks to prevent invoice details from being messed around with. Developers should be aware that the payment hash of an invoice is merely a preimage hash and does not commit to payment details like amount, pubkey, etc. It requires custom tooling to produce a malicious invoice and shows the level of sophistication of LN-savvy attackers. Custodial wallets, payment processors, and account management software based on LDK should not be affected if they use "create_inbound_payment" and respect API recommendations. Potential safety issues with invoices have been known since CVE-2020-26896. Good disclosure security practice suggests warning Lightning implementation maintainers beforehand on their respective security communication channels to ease patch coordination.</p>
        <hr>
        <p><i>Updated on: 2023-06-27T04:44:11.253194+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>