<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment! <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/June_2023/003983_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml.html">Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment!</a>
                        <b>callebtc 2023-06-19 15:26:05+00:00</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/June_2023/003986_Potential-vulnerability-in-Lightning-backends-BOLT-11-payment-hash-does-not-commit-to-payment-.xml.html">Potential vulnerability in Lightning backends: BOLT-11 &#34;payment hash&#34; does not commit to payment!</a>
                        <b>Antoine Riard 2023-06-19 20:34:10+00:00</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2023-June/003983.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2023-06-19T15:26:05+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>Last month, the team at LNbits discovered a vulnerability that allowed attackers to create balances out of thin air by exploiting a quirk in how invoices are handled internally. The vulnerability has been patched in LNbits version 0.10.5. The attack involved an attacker inserting a bolt-11 payment hash of payment A into a different payment, creating a malicious invoice B that could trick the backend into believing that B == A.The critical part of the attack was that payment hashes do not commit to any payment details but only to the preimage. To mitigate this issue, backends should use self-generated unique "checking id's" for looking up internal payments or use additional checks to make sure that the invoice details have not been messed around with (e.g., asserting amount(A) == amount(B)).Developers working on custodial wallets, payment processors, account management software, etc. are encouraged to read about the attack since carrying out the same exploit is possible in other Lightning applications. The attack requires a fundamental understanding of bolt-11 and custom tooling to produce the malicious invoice.Good disclosure security practice suggests having previously warned the Lightning implementation maintainers on their respective security communication channels to ease patch coordination if needed with second-line vendors like wallets and processors. Potential safety issues with invoices have been known since CVE-2020-26896.</p>
        <hr>
        <p><i>Updated on: 2023-06-22T01:34:49.864981+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>