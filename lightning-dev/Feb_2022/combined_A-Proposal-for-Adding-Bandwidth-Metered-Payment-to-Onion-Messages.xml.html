<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>A Proposal for Adding Bandwidth Metered Payment to Onion Messages <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/March_2022/003525_A-Proposal-for-Adding-Bandwidth-Metered-Payment-to-Onion-Messages.xml.html">A Proposal for Adding Bandwidth Metered Payment to Onion Messages</a>
                        <b>Olaoluwa Osuntokun 2022-03-23 00:25:40</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2022/003498_A-Proposal-for-Adding-Bandwidth-Metered-Payment-to-Onion-Messages.xml.html">A Proposal for Adding Bandwidth Metered Payment to Onion Messages</a>
                        <b>Olaoluwa Osuntokun 2022-02-24 01:20:28</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2022/003499_A-Proposal-for-Adding-Bandwidth-Metered-Payment-to-Onion-Messages.xml.html">A Proposal for Adding Bandwidth Metered Payment to Onion Messages</a>
                        <b>Rusty Russell 2022-02-24 04:37:46</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-March/003525.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2022-03-23T00:25:40+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>Laolu and Rusty had an email conversation about Lightning Network technology, discussing topics such as AMP and keysend specifications. Lightning Labs proposed a way to expand the scope of the Lightning Network beyond being just a decentralized peer-to-peer payment system by introducing onion messaging, which would allow for sending and receiving invoices directly over the existing Lightning Network. However, there were issues with unsolicited messages, lack of compensation for network bandwidth expended by forwarding nodes, and rate limiting policies not being concretely addressed.To address these issues, the Lightning Network has proposed a two-phase onion messaging session creation process in which the sender purchases forwarding bandwidth from intermediate nodes and requests session creation with the receiver in a single atomic step. Once successful session creation is achieved, the sender can use the purchased bandwidth to send messages to the receiver. Additionally, the proposal suggests using AMP to extend push payment to a receiver for the purchase of bandwidth sessions.Nodes add new TLVs to their node announcement to express a new fee rate for forwarding messages and also include a feature bit to indicate that they only accept payment for forwarding. A 32-byte session identifier is transmitted to each intermediate hop using a new TLV within the existing HTLC (Hashed TimeLock Contract) onion blob. The proposed system expands the scope of LN to support pseudonymous messaging and arbitrary data transfer across the network.During session creation, the sender creates new onion_session_id's for all nodes in the messaging route it doesn't already have an active session with. To initiate session creation, the node sends an AMP payment to the receiver that drops off the proper fee to each intermediate hop along with the proposed onion_session_id. Session creation is rejected if the receiver chooses to fail back any of the AMP HTLC splits. Once a session has been finalized, the sender can use it to send messages to the receiver. When forwarding onion messages, nodes check that the session hasn't expired and the session also has enough bandwidth left.The proposed system supplements the existing fee revenue of nodes, potentially making it more sustainable to run a Lightning node. Laolu and Rusty also discussed the idea of charging for forwarding onion messages, which can be implemented on top of existing onion_messages. They made references to specific resources such as bLIP and BOLT tracker. Furthermore, they touched upon incentivizing nodes to reliably forward messages.</p>
        <hr>
        <p><i>Updated on: 2023-06-03T07:40:14.370724+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>