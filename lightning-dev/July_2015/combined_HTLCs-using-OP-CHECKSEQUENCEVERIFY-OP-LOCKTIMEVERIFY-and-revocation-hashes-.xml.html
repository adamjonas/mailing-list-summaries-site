<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes. <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/July_2015/000021_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Rusty Russell 2015-07-06 06:41:34</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2015/000024_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>CJP 2015-07-07 19:51:54</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2015/000025_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Adam Back 2015-07-07 19:59:28</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2015/000056_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Rusty Russell 2015-07-24 00:54:05</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000433_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>CJP 2016-02-08 22:07:53</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000441_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Anthony Towns 2016-02-10 16:50:49</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2015/000027_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Rusty Russell 2015-07-08 00:32:34</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2015/000054_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Anthony Towns 2015-07-23 05:07:33</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000437_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Anthony Towns 2016-02-09 08:59:56</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000438_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>CJP 2016-02-09 19:48:59</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000439_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Rusty Russell 2016-02-09 23:14:46</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000440_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Rusty Russell 2016-02-10 01:15:16</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000434_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>Rusty Russell 2016-02-08 23:39:12</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Feb_2016/000442_HTLCs-using-OP-CHECKSEQUENCEVERIFY-OP-LOCKTIMEVERIFY-and-revocation-hashes-.xml.html">HTLCs using OP_CHECKSEQUENCEVERIFY/OP_LOCKTIMEVERIFY and revocation hashes.</a>
                        <b>CJP 2016-02-11 21:00:32</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-July/000021.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2015-07-06T06:41:34+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The Lightning Network is a second-layer scaling solution designed to improve the scalability of the Bitcoin network. It requires hash time-locked contracts (HTLCs) to function, with both commitment transactions getting an additional output per HTLC. These outputs are spendable under four conditions: the recipient knows the R value; the HTLC has timed out; the HTLC has been revoked; or the commit transaction has been revoked. Private keys were originally used as a means of revoking transactions, but "revocation preimages" are now used instead, which is considered an improvement. The design change allows for more efficiency and ease of use.In a hypothetical scenario involving two parties, Alice and Eve, connected with two channels, a potential problem with the Lightning Network was identified where Eve could steal funds from Alice. However, since revocation pre-images have been exchanged, Alice can immediately spend the HTLC using either the HTLC-TIMEOUT & SIG-PAYER clause or the REVOCATION-E & SIG A clause. The email thread further discusses the question of which times out first, Alice's CSV or Eve's CLTV, and concludes that Alice's CSV should be the first to time out. Finally, the thread assumes that the HTLC timeout is T0 + 1 day on the channel where Eve receives, T0 + 2 days on the channel where Eve sends, and states that Alice's CSV should have a delay less than one day.Rusty Russell presented four possible choices for closing a payment channel: keeping the channel open, having the other party close it unilaterally, closing it unilaterally oneself, or cooperatively closing it together. He argues that cooperative closing is preferred due to the disadvantages of OP_CSV delay in unilateral closing. In an email from Rusty Russell on July 6, 2015, the commitment transaction of Lightning Network was explained. Each side maintains a commitment transaction with two outputs, one paying to self and the other paying to the other side. The last two failure modes are separate from each other because HTLCs have different lifetimes from commit transactions.Rusty Russell generalized the concept of revocable transactions further by using a hypercube multi-dimensional array of preimages to reduce setup time. In a post, he explains that all outputs to A in A's commit transaction must be delayed via OP_CSV, including HTLC outputs. He suggests longer delays to catch the use of revoked commit transactions, while shorter HTLC timeout increments lock up funds for shorter periods.In a discussion with Anthony Towns, they identified four options for closing channels: keeping the channel open, unilateral closure by either party, or cooperative closure. They ranked them as d > b > c. Rusty expressed concern over the party going offline and paying the least penalty while their counterparties have their funds tied up. He proposes delaying all outputs to A in A's commit transaction via OP_CSV, including HTLC outputs, to avoid theft escalation caused by downtime/DoS attack. The Lightning Network's HTLC system has been subject to potential issues, and Rusty proposed delaying all non-revocation paths in HTLCs and straight payment outputs to prevent the problem. The email thread also discussed the problem of intertwinement of channel balance and collateral and suggested implementing both types of solutions if there is demand for it, using them side by side in Amiko Pay.</p>
        <hr>
        <p><i>Updated on: 2023-06-03T15:04:06.113430+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>