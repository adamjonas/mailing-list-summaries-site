<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>CVE-2020-26896: LND Invoice Preimage Extraction</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Conner Fromknecht 2020-10-20 21:52:29
            <br><i>Published on: 2020-10-20T21:52:29+00:00</i></p>

        
        

        
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>A vulnerability in the Lightning Network Daemon (LND) has been discovered, which could allow an attacker to steal bitcoin from other nodes. The vulnerability (CVE-2020-26896) affects any LND node permitting HTLC forwarding and operating as any form of merchant node. However, nodes that use rejecthtlc=1 are not affected. To exploit the vulnerability, the attacker intercepts a real or single-sharded MPP HTLC before creating a malicious HTLC with the same payment hash. They then route the malicious HTLC through the victim and back to themselves and trigger a unilateral close of the channel. The victim would promptly broadcast the HTLC-success transaction for the malicious HTLC, revealing the target invoice preimage on-chain when the incoming HTLC is claimed. Due to the bug, the preimage provided to sweep the malicious HTLC is obtained from the invoice database as a fallback to the (forwarded) preimage database, rather than being ignored. The victim would believe they had received the full payment when they had only received routing fees, while the attacker would have diverted the payment to themselves. The vulnerability was discovered by Antoine Riard and has been patched in LND v0.11.0-beta. Implementations are also encouraged to make payment secrets required by default, which would prevent attackers from guessing the payment secret. PGP signatures are used to authenticate the sender of a message and ensure its integrity. The signature is a long string of characters that includes a public key and a hash of the original message. The purpose of PGP signatures is to prevent tampering and impersonation in electronic communication. PGP (Pretty Good Privacy) is widely used encryption software that allows users to protect their emails and files with strong cryptography. It uses a combination of symmetric and asymmetric encryption, as well as digital signatures, to ensure the privacy and authenticity of data. Digital signatures are created by hashing the original message and encrypting the hash with the sender's private key. The recipient can then verify the signature by decrypting the hash with the sender's public key and comparing it to the hash of the received message. Overall, PGP signatures are an important tool for secure communication and help to protect against fraud and cyber attacks.</p>
    <hr>
    <p><i> Updated on: 2023-06-01T18:35:54.294243+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>