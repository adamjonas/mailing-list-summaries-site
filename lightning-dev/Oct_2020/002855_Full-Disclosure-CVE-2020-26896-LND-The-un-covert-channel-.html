<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Full Disclosure: CVE-2020-26896 LND &#34;The (un)covert channel&#34;</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Antoine Riard 2020-10-20 22:05:18
            <br><i>Published on: 2020-10-20T22:05:18+00:00</i></p>

        
        

        
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>A vulnerability has been discovered in Lightning Network Daemon (LND) prior to version 0.11 that could allow a malicious peer to steal an intercepted hash time-locked contract (HTLC). When LND had relayed the HTLC hash-and-amount collision with an expected payment HTLC on the same channel, it would release the preimage for the later while claiming on-chain the former. This issue was due to the vulnerability in its invoice database while claiming on-chain a received HTLC output, it didn't verify that the corresponding outgoing off-chain HTLC was already settled before releasing the preimage. A malicious peer could have deliberately intercepted an HTLC intended for the victim node, probed the preimage through a colluding relayed HTLC and stolen the intercepted HTLC.This vulnerability was exposing routing nodes also receiving payments, such as merchant nodes. A peer servicing as an intermediary hop of a payment path could have guessed that the next hop is the final receiver by comparing the HTLC's amount_msat with any goods/services advertised by the victim node merchant website. The current spec requirement is "a local node if it receives (or already possesses) a payment preimage for an unresolved HTLC output that it has been offered AND for which it has committed to an outgoing HTLC MUST resolve the output by spending it, using the HTLC-Success transaction". The LN ecosystem is advised to consider mandatory deployment of `payment_secret`, reducing the surface area for this class of bugs, among other benefits. The vulnerability was discovered while working on Rust-Lightning, and a quick manual test against LND confirmed this vulnerability. The LND team released v0.11.0-beta with a fix, and users are encouraged to upgrade to LND v0.11.x ASAP. A partial disclosure was made on October 8, 2020, and a full disclosure was made on October 20, 2020.</p>
    <hr>
    <p><i> Updated on: 2023-06-01T18:36:33.096055+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>