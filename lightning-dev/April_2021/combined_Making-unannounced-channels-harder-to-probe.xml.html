<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Making unannounced channels harder to probe <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/April_2021/003010_Making-unannounced-channels-harder-to-probe.xml.html">Making unannounced channels harder to probe</a>
                        <b>Rusty Russell 2021-04-24 04:09:18</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/April_2021/003012_Making-unannounced-channels-harder-to-probe.xml.html">Making unannounced channels harder to probe</a>
                        <b>Joost Jager 2021-04-24 05:51:40</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/April_2021/003014_Making-unannounced-channels-harder-to-probe.xml.html">Making unannounced channels harder to probe</a>
                        <b>Rusty Russell 2021-04-24 05:57:46</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2021-April/003010.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2021-04-24T04:09:18+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>In a recent discussion about the Lightning Network payment protocol, Joost Jager corrected Rusty's statement regarding the need to know the node_id of the next node. Jager pointed out that if the node_id is incorrect, one can send an `update_fail_malformed_htlc` with failure code `invalid_onion_hmac`, which node N turns into its own failure message. This error is not common on modern networks as onion implementations have been reliable. However, probing for a channel ID attached to node N by sending an HTLC and seeing whether the error reply comes from the N or the next hop is not the real answer. Blinded paths should be used instead. In cases where someone offers an invoice, they can probe the rest of the network to find all unannounced channels. In such cases, implementations could choose to return `update_fail_malformed_htlc` failure_code=invalid_onion_hmac as above on anything that comes through an unannounced channel but is not a successful payment.Further exploration of this topic can be found in a Twitter thread shared by Cycryptr. Rusty later apologized for misreading Joost's tweet and thanked him for pointing out his mistake.</p>
        <hr>
        <p><i>Updated on: 2023-06-04T01:20:48.523922+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>