<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Final expiry probing attack</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Joost Jager 2019-04-09 09:14:08
            <br><i>Published on: 2019-04-09T09:14:08+00:00</i></p>

        
        

        
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-April/001972.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>In a recent pull request on GitHub, the Lightning Network's incorrect_or_unknown_payment_details failure message was extended with an htlc_msat field to replace the previous incorrect_payment_amount message. This change was made to prevent a probing attack that allowed an intermediate node to determine the final destination of a payment. However, a question was raised about whether the same change should be applied to the cltv expiry. Currently, lnd returns a final_expiry_too_soon message if the htlc expiry does not meet the invoice cltv delta requirement. This could also be used for probing by using low expiry values. The proposed change would be to return an incorrect_or_unknown_payment_details failure message (with a new htlc_expiry field) when the htlc expiry does not meet the invoice cltv delta requirement. This change would help prevent probing attacks and enhance the security of the Lightning Network.</p>
    <hr>
    <p><i> Updated on: 2023-06-01T18:10:01.691710+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>