<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Disclosure of a fee blackmail attack that can make a victim loose almost all funds of a non Wumbo channel and potential fixes</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Olaoluwa Osuntokun 2020-06-22 01:09:28
            <br><i>Published on: 2020-06-22T01:09:28+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/June_2020/combined_Disclosure-of-a-fee-blackmail-attack-that-can-make-a-victim-loose-almost-all-funds-of-a-non-Wumbo-channel-and-potential-fixes.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-June/002750.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>The Lightning Network protocol has been found to be vulnerable to a new attack known as "flood and blackmail." This attack involves flooding the network with simultaneous, large transactions that cause the channels between nodes to freeze, preventing further payments from being made. An attacker could demand blackmail payments from victims in exchange for unfreezing the channel and returning part of the lost funds.To execute the attack, an attacker can game the autopilot and create many channels, making them a highly likely channel partner for autopilot users. To mitigate the attack, eclaire has set a constant cap of 483 htlcs per channel, while c-lightning and lnd did not have a default hard cap until recently. Lowering the maximum number of concurrent HTLCs seems to be a reasonable start towards fixing this issue. Anchor commitments can also help mitigate the attack by letting initiators select a very low starting fee and also bump the fees of second-level HTLC transactions.It's worth noting that if the attacker attempts this with minimal setup, then they'll need to be the ones that open the channel, which would render this attempt moot since they'll actually be the ones paying the fees. Alternatively, they could use something like Lightning Loop to gain the outbound bandwidth needed to attempt this attack, but they'll need to pay for that bandwidth, adding a further cost to the attack. The attack isn't costless as they'll need to acquire outbound liquidity for an incoming channel and also need to pay fees independent of the "success" of their attack.Several ideas for fixes have been proposed, including not using the maximum value of htlc's, implementing bitcoin core PR #15681, not overpaying fees in commitment transactions, not adding htlcs for which the on-chain fee is higher than the htlc's value, finding a way to aggregate htlcs, and splitting on-chain fees differently. Additionally, it is suggested that there should be a hint in the readme file about how to disclose attacks and vulnerabilities.Overall, the Lightning Network vulnerability highlights the need for continued development and improvement of second-layer solutions for Bitcoin transactions.</p>
    <hr>
    <p><i> Updated on: 2023-05-23T04:00:31.544869+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>