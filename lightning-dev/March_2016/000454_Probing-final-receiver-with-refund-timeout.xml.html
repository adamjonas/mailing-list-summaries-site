<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Probing final receiver with refund timeout</h1>
    <hr class="solid">
    
    <ul>
        
        
            <p><b>Author:</b> Rusty Russell 2016-03-05 09:28:36
            <br><i>Published on: 2016-03-05T09:28:36+00:00</i></p>

        
        

        
        
        <li>
        <a href="/lightning-dev/March_2016/combined_Probing-final-receiver-with-refund-timeout.xml.html"> Combined Summary of all posts in thread </a>
        </li>
        
        <li>
            
                <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2016-March/000454.html">Click here to read original discussion on the lightning-dev mailing list</a>
            
        </li>

    </ul>

    <hr>
    <h3> Summary:</h3>
    <p>A vulnerability in the onion routing of Bitcoin's lightning network has been discovered by Mats Jerratsch via Lightning-dev. It is possible to attack the system with probing too short of an absolute CLTV refund timeout. When accepting a payment, one will check if the remaining timeout > MIN_TIMEOUT. One solution for this particular attack would be to remember the onion and always fail an identical one. However, this would allow a single probe, which asks "are you the final destination?". Additionally, the timeout for the next hop should probably be somewhat randomized, at least subtracting (MIN_TIMEOUT to MIN_TIMEOUT*2). The question remains about what HTLC timeout should be set to initially. Even if it is randomized, over time the pattern would reveal to your peer if you are originating all the HTLCS.</p>
    <hr>
    <p><i> Updated on: 2023-05-23T22:39:02.204988+00:00 </i></p>
    
    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>