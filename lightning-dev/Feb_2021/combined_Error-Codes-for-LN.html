<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>Error Codes for LN <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/Feb_2021/002964_Error-Codes-for-LN.html">Error Codes for LN</a>
                        <b>Carla Kirk-Cohen 2021-02-12 07:34:04</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2021/003142_Error-Codes-for-LN.html">Error Codes for LN</a>
                        <b>Carla Kirk-Cohen 2021-07-28 08:25:52</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/July_2021/003110_Error-Codes-for-LN.html">Error Codes for LN</a>
                        <b>Rusty Russell 2021-07-07 00:36:37</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2021-February/002964.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2021-02-12T07:34:04+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>Carla Kirk-Cohen proposed to re-purpose the existing error message in the Lightning Network spec to allow for more structured errors and create a path for standardized, enriched errors going forward. The new error message should contain an error code and optional metadata instead of an arbitrary string, which will provide better debugging information, clearer information for the end-user, reduced risk of leaking information, and more fine-grained error handling based on the error code. To achieve this, TLV fields can be added after the data field since non-ascii values are not allowed in the error string itself. In an email exchange between Rusty and Carla, they discussed adding specific error codes using TLV fields after the data field and how to support nodes that have not upgraded. Rusty proposed a straw proposal including types such as erroneous_message, erroneous_fieldnum, and suggested_value. The new error message provides an error code that tells exactly what has gone wrong, and metadata pointing to the HTLC with an invalid signature. Carla suggested adding an error_code enum where timeout is one of the cases. Rusty also proposed adding the TLV to warnings. The context then shifts to fee updates and a misguided feature bit. The author suggests that if Alice requires a feature bit which Bob doesn't offer, it is on Bob to comply. The author notes that all issues with the exception of timeouts can be expressed in the form "problem is this message, this field" and suggests having a special TLV case for timeouts in the message. Rusty believes that the spec indicates that senders/recipients of errors `MUST` fail the channel referenced in the error, but he thinks this isn't practical. In a recent spec meeting, Carla Kirk-Cohen raised the idea of adding more specific error codes. It was suggested that error codes could be added by using TLV fields after the data field, and nodes that haven't been upgraded could include the error code in the data field or introduce a feature bit. Older nodes should ignore extra fields, and all defined types are now assumed to have an optional TLV appended. While not every possible error can be enumerated, many cases in the spec where explicit error codes could be introduced. This new kind of error provides an error code that tells exactly what has gone wrong and metadata pointing to the htlc with an invalid sig. Exceptions are funding process timeout, fees out of range, funding tx spent, funding params unacceptable, HTLC timeout, update fee too low/high. Additionally, a special TLV case for timeouts in the message may be worth considering.</p>
        <hr>
        <p><i>Updated on: 2023-06-04T01:15:30.395068+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>