<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>Atom Feed Display</title>
    <link rel="stylesheet" href="../../archive_styles.css">
</head>

<body BGCOLOR="#fffffb">
    
    <h1>A state machine. <span class="combined-summary">[combined summary]</span></h1>
    <hr class="solid">
    <br><b>Individual post summaries:</b>
    
        <ul>
            
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000157_A-state-machine-.xml.html">A state machine.</a>
                        <b>Pierre 2015-08-29 12:50:44</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000164_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-08-31 00:34:03</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000165_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-08-31 01:04:21</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000137_A-state-machine-.xml.html">A state machine.</a>
                        <b>Pierre 2015-08-20 18:20:04</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Sept_2015/000180_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-09-02 05:55:44</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Sept_2015/000183_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-09-04 05:35:37</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000136_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-08-20 07:52:11</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000138_A-state-machine-.xml.html">A state machine.</a>
                        <b>Pierre 2015-08-20 18:36:09</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000156_A-state-machine-.xml.html">A state machine.</a>
                        <b>Anthony Towns 2015-08-29 07:42:39</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000160_A-state-machine-.xml.html">A state machine.</a>
                        <b>Anthony Towns 2015-08-30 00:51:54</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000166_A-state-machine-.xml.html">A state machine.</a>
                        <b>Anthony Towns 2015-08-31 02:24:26</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Sept_2015/000177_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-09-01 07:32:49</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Sept_2015/000178_A-state-machine-.xml.html">A state machine.</a>
                        <b>Anthony Towns 2015-09-01 22:32:42</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Sept_2015/000181_A-state-machine-.xml.html">A state machine.</a>
                        <b>Jasper Hugunin 2015-09-02 19:36:44</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000142_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-08-21 01:33:52</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000144_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-08-21 01:27:22</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000145_A-state-machine-.xml.html">A state machine.</a>
                        <b>Rusty Russell 2015-08-21 05:32:32</b>
                    </li>
                
                    <li>
                        <a href="/lightning-dev/Aug_2015/000154_A-state-machine-.xml.html">A state machine.</a>
                        <b>Pierre 2015-08-28 16:55:31</b>
                    </li>
                
            
        </ul>
        
            <a href="https://lists.linuxfoundation.org/pipermail/lightning-dev/2015-August/000157.html">Click here to read the original discussion on the lightning-dev mailing list</a>
        
        <p><i>Published on: 2015-08-29T12:50:44+00:00</i></p>
        <hr>
        <h3>Summary:</h3>
        <p>The Lightning Network protocol is a complex system that handles all commands and bitcoin event notifications. It includes various states and inputs, such as packet inputs like open, update, and close, as well as non-packet inputs like Bitcoin events and timeouts. The protocol responds to protocol violations with an error packet and unilateral close. Rusty Russell has proposed updates to the protocol, including allowing multiple hash time-locked contracts (HTLCs) to be updated at once and simplifying the CMD_CLOSE option. He also suggested adding a current time field to UPDATE_ADD_HTLC to defuse clock sync problems earlier.In email conversations with Anthony Towns and Jasper, Rusty discussed potential deadlocks and livelocks in the protocol and proposed solutions such as combining updates through PKT_SIMULTANEOUS_ACCEPT and allowing CMD_CLOSE at any time except when already closing. The conversations also highlighted the difficulty in knowing which bugs will cause monetary losses and the need to assume strangers on the network may have bug-infested software.Pierre provided an explanation of the sequence of events in a multi-party transaction involving multiple channels, while also raising concerns about assumptions made in the OPEN_WAITING state. Rusty clarified Bob's state in an Alice->Bob->Carol->Dave scenario and confirmed the correctness of the first three transitions.Rusty also suggests changes to the state diagram of the lightning network protocol, proposing laying out the diagram differently and combining error paths that apply to many states in the output. There is a discussion about the optimization of updating many HTLCs at once rather than using ADD_HTLC, COMPLETE_HTLC, TIMEOUT_HTLC, etc. Pierre raises concerns regarding the order of events in the Lightning Network protocol, which Rusty addresses in detail. In addition, there are discussions about the git tree, software bugs, and the need for simplicity.The Lightning Network channel is complex and includes several states and transitions. The states are grouped into four categories: WAIT_FOR_HTLC_ACCEPT_LOWPRIO, WAIT_FOR_HTLC_ACCEPT_HIGHPRIO, WAIT_FOR_UPDATE_ACCEPT_LOWPRIO, and WAIT_FOR_UPDATE_COMPLETE_LOWPRIO. There are also wait states such as WAIT_FOR_HTLC_ACCEPT_LOWPRIO and WAIT_FOR_UPDATE_COMPLETE_HIGHPRIO, each with its own set of commands and responses.Specific signals like BITCOIN_CLOSE_DONE and INPUT_CLOSE_COMPLETE_TIMEOUT are also handled through specific states. Normal closing of the channel is described with three states: WAIT_FOR_CLOSE_COMPLETE, WAIT_FOR_CLOSE_ACK, and CLOSE_WAIT_CLOSE. However, there are weirder closing states that are used when transactions have been stolen or closed unilaterally. These states include CLOSE_WAIT_STEAL, CLOSE_WAIT_SPENDTHEM, CLOSE_WAIT_SPENDOURS, and CLOSE_WAIT_STEAL_SPENDOURS, for handling different types of signals. Each state can have different transitions based on various packets and commands received.Apart from the Lightning Network channel, there are also events and transitions related to Bitcoin transactions. These events are labeled with statuses such as WAIT, STEAL, SPEND_THEIRS, CLOSE, OURCOMMIT, or ANCHOR. Transitions involve BITCOIN_SPEND_THEIRS_DONE and ultimately lead to the status CLOSED. Other transitions involve BITCOIN_STEAL_DONE and BITCOIN_CLOSE_DONE. There are also transitions involving BITCOIN_ANCHOR, leading to different statuses depending on the type of anchor.Overall, the complex network of actions and statuses involved in the Lightning Network channel and Bitcoin transactions require careful monitoring and management. Rusty Russell and others are constantly working to improve and update the protocol to make it more efficient and secure.</p>
        <hr>
        <p><i>Updated on: 2023-06-01T23:41:20.380677+00:00</i></p>
    

    

    <footer>
        <span style="font-family: Arial, Helvetica, sans-serif;">&#10084;&#65039;</span> <a href="https://chaincode.com" target="_blank" rel="noreferrer" style="text-decoration: none; color: inherit;">Chaincode</a>
    </footer>
</body>

</html>